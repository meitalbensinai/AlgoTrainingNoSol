

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cookbook &#8212; pandas 0.24.0 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pandas Ecosystem" href="../ecosystem.html" />
    <link rel="prev" title="Frequently Asked Questions (FAQ)" href="gotchas.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ecosystem.html" title="pandas Ecosystem"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="gotchas.html" title="Frequently Asked Questions (FAQ)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pandas 0.24.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">User Guide</a> &#187;</li> 
      </ul>
    </div>
<div class="content-wrapper">
    <div class="content">
        <div class="document">
            <div class="sphinxsidebar">
                <h3>Table Of Contents</h3>
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../whatsnew/v0.24.0.html">What's New in 0.24.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="io.html">IO Tools (Text, CSV, HDF5, …)</a></li>
<li class="toctree-l2"><a class="reference internal" href="indexing.html">Indexing and Selecting Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html">MultiIndex / Advanced Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="merging.html">Merge, join, and concatenate</a></li>
<li class="toctree-l2"><a class="reference internal" href="reshaping.html">Reshaping and Pivot Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="text.html">Working with Text Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="missing_data.html">Working with missing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="categorical.html">Categorical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="integer_na.html">Nullable Integer Data Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="computation.html">Computational tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="groupby.html">Group By: split-apply-combine</a></li>
<li class="toctree-l2"><a class="reference internal" href="timeseries.html">Time Series / Date functionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="timedeltas.html">Time Deltas</a></li>
<li class="toctree-l2"><a class="reference internal" href="style.html">Styling</a></li>
<li class="toctree-l2"><a class="reference internal" href="options.html">Options and Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="enhancingperf.html">Enhancing Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse.html">Sparse data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="gotchas.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Cookbook</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystem.html">pandas Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew/index.html">Release Notes</a></li>
</ul>

                <h3 style="margin-top: 1.5em;">Search</h3>

                <form class="search" action="../search.html" method="get">
                    <input type="text" name="q" size="18"/>
                    <input type="submit" value="Go"/>
                    <input type="hidden" name="check_keywords" value="yes"/>
                    <input type="hidden" name="area" value="default"/>
                </form>
                <p class="searchtip" style="font-size: 90%">
                    Enter search terms or a module, class or function name.
                </p>

            </div>
             
            <div class="documentwrapper">
                <div class="bodywrapper">
                    <div class="body">
                        
  <div class="section" id="cookbook">
<span id="id1"></span><h1>Cookbook<a class="headerlink" href="#cookbook" title="Permalink to this headline">¶</a></h1>
<p>This is a repository for <em>short and sweet</em> examples and links for useful pandas recipes.
We encourage users to add to this documentation.</p>
<p>Adding interesting links and/or inline examples to this section is a great <em>First Pull Request</em>.</p>
<p>Simplified, condensed, new-user friendly, in-line examples have been inserted where possible to
augment the Stack-Overflow and GitHub links.  Many of the links contain expanded information,
above what the in-line examples offer.</p>
<p>Pandas (pd) and Numpy (np) are the only two abbreviated imported modules. The rest are kept
explicitly imported for newer users.</p>
<p>These examples are written for Python 3.  Minor tweaks might be necessary for earlier python
versions.</p>
<div class="section" id="idioms">
<h2>Idioms<a class="headerlink" href="#idioms" title="Permalink to this headline">¶</a></h2>
<p id="cookbook-idioms">These are some neat pandas <code class="docutils literal notranslate"><span class="pre">idioms</span></code></p>
<p><a class="reference external" href="https://stackoverflow.com/questions/17128302/python-pandas-idiom-for-if-then-else">if-then/if-then-else on one column, and assignment to another one or more columns:</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">   ...: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="gp">   ...: </span>                   <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]})</span>
<span class="gp">   ...: </span>

<span class="gp">In [2]: </span><span class="n">df</span>
<span class="gh">Out[2]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>
</pre></div>
</div>
<div class="section" id="if-then">
<h3>if-then…<a class="headerlink" href="#if-then" title="Permalink to this headline">¶</a></h3>
<p>An if-then on one column</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;BBB&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="gp">In [4]: </span><span class="n">df</span>
<span class="gh">Out[4]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   -1   50</span>
<span class="go">2    6   -1  -30</span>
<span class="go">3    7   -1  -50</span>
</pre></div>
</div>
<p>An if-then with assignment to 2 columns:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;BBB&#39;</span><span class="p">,</span> <span class="s1">&#39;CCC&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">555</span>

<span class="gp">In [6]: </span><span class="n">df</span>
<span class="gh">Out[6]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5  555  555</span>
<span class="go">2    6  555  555</span>
<span class="go">3    7  555  555</span>
</pre></div>
</div>
<p>Add another line with different logic, to do the -else</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;BBB&#39;</span><span class="p">,</span> <span class="s1">&#39;CCC&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="gp">In [8]: </span><span class="n">df</span>
<span class="gh">Out[8]: </span><span class="go"></span>
<span class="go">   AAA   BBB   CCC</span>
<span class="go">0    4  2000  2000</span>
<span class="go">1    5   555   555</span>
<span class="go">2    6   555   555</span>
<span class="go">3    7   555   555</span>
</pre></div>
</div>
<p>Or use pandas where after you’ve set up a mask</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">df_mask</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">   ...: </span>                        <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">   ...: </span>                        <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">})</span>
<span class="gp">   ...: </span>

<span class="gp">In [10]: </span><span class="n">df</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_mask</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">)</span>
<span class="gh">Out[10]: </span><span class="go"></span>
<span class="go">   AAA   BBB   CCC</span>
<span class="go">0    4 -1000  2000</span>
<span class="go">1    5 -1000 -1000</span>
<span class="go">2    6 -1000   555</span>
<span class="go">3    7 -1000 -1000</span>
</pre></div>
</div>
<p><a class="reference external" href="https://stackoverflow.com/questions/19913659/pandas-conditional-creation-of-a-series-dataframe-column">if-then-else using numpy’s where()</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]})</span>
<span class="gp">   ....: </span>

<span class="gp">In [12]: </span><span class="n">df</span>
<span class="gh">Out[12]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [13]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;logic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AAA&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">df</span>
<span class="gh">Out[14]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC logic</span>
<span class="go">0    4   10  100   low</span>
<span class="go">1    5   20   50   low</span>
<span class="go">2    6   30  -30  high</span>
<span class="go">3    7   40  -50  high</span>
</pre></div>
</div>
</div>
<div class="section" id="splitting">
<h3>Splitting<a class="headerlink" href="#splitting" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/14957116/how-to-split-a-dataframe-according-to-a-boolean-criterion">Split a frame with a boolean criterion</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]})</span>
<span class="gp">   ....: </span>

<span class="gp">In [16]: </span><span class="n">df</span>
<span class="gh">Out[16]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [17]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">]</span>
<span class="go">                                                                                               Out[17]: </span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>

<span class="gp">In [18]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
<span class="go">                                                                                                                                                            Out[18]: </span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>
</pre></div>
</div>
</div>
<div class="section" id="building-criteria">
<h3>Building Criteria<a class="headerlink" href="#building-criteria" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/15315452/selecting-with-complex-criteria-from-pandas-dataframe">Select with multi-column criteria</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]})</span>
<span class="gp">   ....: </span>

<span class="gp">In [20]: </span><span class="n">df</span>
<span class="gh">Out[20]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>
</pre></div>
</div>
<p>…and (without assignment returns a Series)</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BBB&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">40</span><span class="p">),</span> <span class="s1">&#39;AAA&#39;</span><span class="p">]</span>
<span class="gh">Out[21]: </span><span class="go"></span>
<span class="go">0    4</span>
<span class="go">1    5</span>
<span class="go">Name: AAA, dtype: int64</span>
</pre></div>
</div>
<p>…or (without assignment returns a Series)</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BBB&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">40</span><span class="p">),</span> <span class="s1">&#39;AAA&#39;</span><span class="p">]</span>
<span class="gh">Out[22]: </span><span class="go"></span>
<span class="go">0    4</span>
<span class="go">1    5</span>
<span class="go">2    6</span>
<span class="go">3    7</span>
<span class="go">Name: AAA, dtype: int64</span>
</pre></div>
</div>
<p>…or (with assignment modifies the DataFrame.)</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BBB&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;AAA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="gp">In [24]: </span><span class="n">df</span>
<span class="gh">Out[24]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0  0.1   10  100</span>
<span class="go">1  5.0   20   50</span>
<span class="go">2  0.1   30  -30</span>
<span class="go">3  0.1   40  -50</span>
</pre></div>
</div>
<p><a class="reference external" href="https://stackoverflow.com/questions/17758023/return-rows-in-a-dataframe-closest-to-a-user-defined-number">Select rows with data closest to certain value using argsort</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]})</span>
<span class="gp">   ....: </span>

<span class="gp">In [26]: </span><span class="n">df</span>
<span class="gh">Out[26]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [27]: </span><span class="n">aValue</span> <span class="o">=</span> <span class="mf">43.0</span>

<span class="gp">In [28]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">CCC</span> <span class="o">-</span> <span class="n">aValue</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
<span class="gh">Out[28]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">1    5   20   50</span>
<span class="go">0    4   10  100</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>
</pre></div>
</div>
<p><a class="reference external" href="https://stackoverflow.com/questions/21058254/pandas-boolean-operation-in-a-python-list/21058331">Dynamically reduce a list of criteria using a binary operators</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [29]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]})</span>
<span class="gp">   ....: </span>

<span class="gp">In [30]: </span><span class="n">df</span>
<span class="gh">Out[30]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [31]: </span><span class="n">Crit1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&lt;=</span> <span class="mf">5.5</span>

<span class="gp">In [32]: </span><span class="n">Crit2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">BBB</span> <span class="o">==</span> <span class="mf">10.0</span>

<span class="gp">In [33]: </span><span class="n">Crit3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">CCC</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">40.0</span>
</pre></div>
</div>
<p>One could hard code:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">AllCrit</span> <span class="o">=</span> <span class="n">Crit1</span> <span class="o">&amp;</span> <span class="n">Crit2</span> <span class="o">&amp;</span> <span class="n">Crit3</span>
</pre></div>
</div>
<p>…Or it can be done with a list of dynamically built criteria</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="kn">import</span> <span class="nn">functools</span>

<span class="gp">In [36]: </span><span class="n">CritList</span> <span class="o">=</span> <span class="p">[</span><span class="n">Crit1</span><span class="p">,</span> <span class="n">Crit2</span><span class="p">,</span> <span class="n">Crit3</span><span class="p">]</span>

<span class="gp">In [37]: </span><span class="n">AllCrit</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="n">CritList</span><span class="p">)</span>

<span class="gp">In [38]: </span><span class="n">df</span><span class="p">[</span><span class="n">AllCrit</span><span class="p">]</span>
<span class="gh">Out[38]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="selection">
<span id="cookbook-selection"></span><h2>Selection<a class="headerlink" href="#selection" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dataframes">
<h3>DataFrames<a class="headerlink" href="#dataframes" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="indexing.html#indexing"><span class="std std-ref">indexing</span></a> docs.</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/14725068/pandas-using-row-labels-in-boolean-indexing">Using both row labels and value conditionals</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]})</span>
<span class="gp">   ....: </span>

<span class="gp">In [40]: </span><span class="n">df</span>
<span class="gh">Out[40]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [41]: </span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))]</span>
<span class="go">                                                                                               Out[41]: </span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">2    6   30  -30</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/pandas-dev/pandas/issues/2904">Use loc for label-oriented slicing and iloc positional slicing</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [42]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]},</span>
<span class="gp">   ....: </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;boo&#39;</span><span class="p">,</span> <span class="s1">&#39;kar&#39;</span><span class="p">])</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>There are 2 explicit slicing methods, with a third general case</p>
<ol class="arabic simple">
<li>Positional-oriented (Python slicing style : exclusive of end)</li>
<li>Label-oriented (Non-Python slicing style : inclusive of end)</li>
<li>General (Either slicing style : depends on if the slice contains labels or positions)</li>
</ol>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [43]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="s1">&#39;kar&#39;</span><span class="p">]</span>  <span class="c1"># Label</span>
<span class="gh">Out[43]: </span><span class="go"></span>
<span class="go">     AAA  BBB  CCC</span>
<span class="go">bar    5   20   50</span>
<span class="go">boo    6   30  -30</span>
<span class="go">kar    7   40  -50</span>

<span class="go"># Generic</span>
<span class="gp">In [44]: </span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">                                                                                      Out[44]: </span>
<span class="go">     AAA  BBB  CCC</span>
<span class="go">foo    4   10  100</span>
<span class="go">bar    5   20   50</span>
<span class="go">boo    6   30  -30</span>

<span class="gp">In [45]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="s1">&#39;kar&#39;</span><span class="p">]</span>
<span class="go">                                                                                                                                                                            Out[45]: </span>
<span class="go">     AAA  BBB  CCC</span>
<span class="go">bar    5   20   50</span>
<span class="go">boo    6   30  -30</span>
<span class="go">kar    7   40  -50</span>
</pre></div>
</div>
<p>Ambiguity arises when an index consists of integers with a non-zero start or non-unit increment.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [46]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="gp">   ....: </span>        <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]}</span>
<span class="gp">   ....: </span>

<span class="gp">In [47]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>  <span class="c1"># Note index starts at 1.</span>

<span class="gp">In [48]: </span><span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Position-oriented</span>
<span class="gh">Out[48]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">2    5   20   50</span>
<span class="go">3    6   30  -30</span>

<span class="gp">In [49]: </span><span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Label-oriented</span>
<span class="go">                                                             Out[49]: </span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">1    4   10  100</span>
<span class="go">2    5   20   50</span>
<span class="go">3    6   30  -30</span>
</pre></div>
</div>
<p><a class="reference external" href="https://stackoverflow.com/questions/14986510/picking-out-elements-based-on-complement-of-indices-in-python-pandas">Using inverse operator (~) to take the complement of a mask</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]})</span>
<span class="gp">   ....: </span>

<span class="gp">In [51]: </span><span class="n">df</span>
<span class="gh">Out[51]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [52]: </span><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])))]</span>
<span class="go">                                                                                               Out[52]: </span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">1    5   20   50</span>
<span class="go">3    7   40  -50</span>
</pre></div>
</div>
</div>
<div class="section" id="panels">
<h3>Panels<a class="headerlink" href="#panels" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://stackoverflow.com/questions/15364050/extending-a-pandas-panel-frame-along-the-minor-axis">Extend a panel frame by transposing, adding a new dimension, and transposing back to the original dimensions</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [53]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/1/2013&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>

<span class="gp">In [54]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="gp">In [55]: </span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">]</span>

<span class="gp">In [56]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>

<span class="gp">In [57]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>

<span class="gp">In [58]: </span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>

<span class="gp">In [59]: </span><span class="n">pf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Panel</span><span class="p">({</span><span class="s1">&#39;df1&#39;</span><span class="p">:</span> <span class="n">df1</span><span class="p">,</span> <span class="s1">&#39;df2&#39;</span><span class="p">:</span> <span class="n">df2</span><span class="p">,</span> <span class="s1">&#39;df3&#39;</span><span class="p">:</span> <span class="n">df3</span><span class="p">})</span>

<span class="gp">In [60]: </span><span class="n">pf</span>
<span class="gh">Out[60]: </span><span class="go"></span>
<span class="go">&lt;class &#39;pandas.core.panel.Panel&#39;&gt;</span>
<span class="go">Dimensions: 3 (items) x 100 (major_axis) x 4 (minor_axis)</span>
<span class="go">Items axis: df1 to df3</span>
<span class="go">Major_axis axis: 2013-01-01 00:00:00 to 2013-04-10 00:00:00</span>
<span class="go">Minor_axis axis: A to D</span>

<span class="gp">In [61]: </span><span class="n">pf</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">:,</span> <span class="s1">&#39;F&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>

<span class="gp">In [62]: </span><span class="n">pf</span>
<span class="gh">Out[62]: </span><span class="go"></span>
<span class="go">&lt;class &#39;pandas.core.panel.Panel&#39;&gt;</span>
<span class="go">Dimensions: 3 (items) x 100 (major_axis) x 5 (minor_axis)</span>
<span class="go">Items axis: df1 to df3</span>
<span class="go">Major_axis axis: 2013-01-01 00:00:00 to 2013-04-10 00:00:00</span>
<span class="go">Minor_axis axis: A to F</span>
</pre></div>
</div>
<p><a class="reference external" href="https://stackoverflow.com/questions/14650341/boolean-mask-in-pandas-panel">Mask a panel by using np.where and then reconstructing the panel with the new masked values</a></p>
</div>
<div class="section" id="new-columns">
<h3>New Columns<a class="headerlink" href="#new-columns" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/16575868/efficiently-creating-additional-columns-in-a-pandas-dataframe-using-map">Efficiently and dynamically creating new columns using applymap</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [63]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;CCC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">   ....: </span>

<span class="gp">In [64]: </span><span class="n">df</span>
<span class="gh">Out[64]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    1    1    2</span>
<span class="go">1    2    1    1</span>
<span class="go">2    1    2    3</span>
<span class="go">3    3    2    1</span>

<span class="gp">In [65]: </span><span class="n">source_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>   <span class="c1"># Or some subset would work too</span>

<span class="gp">In [66]: </span><span class="n">new_cols</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_cat&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">source_cols</span><span class="p">]</span>

<span class="gp">In [67]: </span><span class="n">categories</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Alpha&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Beta&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">}</span>

<span class="gp">In [68]: </span><span class="n">df</span><span class="p">[</span><span class="n">new_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">source_cols</span><span class="p">]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">categories</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>

<span class="gp">In [69]: </span><span class="n">df</span>
<span class="gh">Out[69]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC  AAA_cat BBB_cat  CCC_cat</span>
<span class="go">0    1    1    2    Alpha   Alpha     Beta</span>
<span class="go">1    2    1    1     Beta   Alpha    Alpha</span>
<span class="go">2    1    2    3    Alpha    Beta  Charlie</span>
<span class="go">3    3    2    1  Charlie    Beta    Alpha</span>
</pre></div>
</div>
<p><a class="reference external" href="https://stackoverflow.com/questions/23394476/keep-other-columns-when-using-min-with-groupby">Keep other columns when using min() with groupby</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [70]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AAA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;BBB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">   ....: </span>

<span class="gp">In [71]: </span><span class="n">df</span>
<span class="gh">Out[71]: </span><span class="go"></span>
<span class="go">   AAA  BBB</span>
<span class="go">0    1    2</span>
<span class="go">1    1    1</span>
<span class="go">2    1    3</span>
<span class="go">3    2    4</span>
<span class="go">4    2    5</span>
<span class="go">5    2    1</span>
<span class="go">6    3    2</span>
<span class="go">7    3    3</span>
</pre></div>
</div>
<p>Method 1 : idxmin() to get the index of the minimums</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [72]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;AAA&quot;</span><span class="p">)[</span><span class="s2">&quot;BBB&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="gh">Out[72]: </span><span class="go"></span>
<span class="go">   AAA  BBB</span>
<span class="go">1    1    1</span>
<span class="go">5    2    1</span>
<span class="go">6    3    2</span>
</pre></div>
</div>
<p>Method 2 : sort then take first of each</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [73]: </span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;BBB&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;AAA&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="gh">Out[73]: </span><span class="go"></span>
<span class="go">   AAA  BBB</span>
<span class="go">0    1    1</span>
<span class="go">1    2    1</span>
<span class="go">2    3    2</span>
</pre></div>
</div>
<p>Notice the same results, with the exception of the index.</p>
</div>
</div>
<div class="section" id="multiindexing">
<span id="cookbook-multi-index"></span><h2>MultiIndexing<a class="headerlink" href="#multiindexing" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="advanced.html#advanced-hierarchical"><span class="std std-ref">multindexing</span></a> docs.</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/14916358/reshaping-dataframes-in-pandas-based-on-column-labels">Creating a MultiIndex from a labeled frame</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [74]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;row&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;One_X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;One_Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;Two_X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.11</span><span class="p">,</span> <span class="mf">1.11</span><span class="p">,</span> <span class="mf">1.11</span><span class="p">],</span>
<span class="gp">   ....: </span>                   <span class="s1">&#39;Two_Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.22</span><span class="p">,</span> <span class="mf">1.22</span><span class="p">,</span> <span class="mf">1.22</span><span class="p">]})</span>
<span class="gp">   ....: </span>

<span class="gp">In [75]: </span><span class="n">df</span>
<span class="gh">Out[75]: </span><span class="go"></span>
<span class="go">   row  One_X  One_Y  Two_X  Two_Y</span>
<span class="go">0    0    1.1    1.2   1.11   1.22</span>
<span class="go">1    1    1.1    1.2   1.11   1.22</span>
<span class="go">2    2    1.1    1.2   1.11   1.22</span>

<span class="go"># As Labelled Index</span>
<span class="gp">In [76]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;row&#39;</span><span class="p">)</span>

<span class="gp">In [77]: </span><span class="n">df</span>
<span class="gh">Out[77]: </span><span class="go"></span>
<span class="go">     One_X  One_Y  Two_X  Two_Y</span>
<span class="go">row                            </span>
<span class="go">0      1.1    1.2   1.11   1.22</span>
<span class="go">1      1.1    1.2   1.11   1.22</span>
<span class="go">2      1.1    1.2   1.11   1.22</span>

<span class="go"># With Hierarchical Columns</span>
<span class="gp">In [78]: </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([</span><span class="nb">tuple</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">))</span>
<span class="gp">   ....: </span>                                        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
<span class="gp">   ....: </span>

<span class="gp">In [79]: </span><span class="n">df</span>
<span class="gh">Out[79]: </span><span class="go"></span>
<span class="go">     One        Two      </span>
<span class="go">       X    Y     X     Y</span>
<span class="go">row                      </span>
<span class="go">0    1.1  1.2  1.11  1.22</span>
<span class="go">1    1.1  1.2  1.11  1.22</span>
<span class="go">2    1.1  1.2  1.11  1.22</span>

<span class="go"># Now stack &amp; Reset</span>
<span class="gp">In [80]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [81]: </span><span class="n">df</span>
<span class="gh">Out[81]: </span><span class="go"></span>
<span class="go">    level_1     X     Y</span>
<span class="go">row                    </span>
<span class="go">0       One  1.10  1.20</span>
<span class="go">0       Two  1.11  1.22</span>
<span class="go">1       One  1.10  1.20</span>
<span class="go">1       Two  1.11  1.22</span>
<span class="go">2       One  1.10  1.20</span>
<span class="go">2       Two  1.11  1.22</span>

<span class="go"># And fix the labels (Notice the label &#39;level_1&#39; got added automatically)</span>
<span class="gp">In [82]: </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sample&#39;</span><span class="p">,</span> <span class="s1">&#39;All_X&#39;</span><span class="p">,</span> <span class="s1">&#39;All_Y&#39;</span><span class="p">]</span>

<span class="gp">In [83]: </span><span class="n">df</span>
<span class="gh">Out[83]: </span><span class="go"></span>
<span class="go">    Sample  All_X  All_Y</span>
<span class="go">row                     </span>
<span class="go">0      One   1.10   1.20</span>
<span class="go">0      Two   1.11   1.22</span>
<span class="go">1      One   1.10   1.20</span>
<span class="go">1      Two   1.11   1.22</span>
<span class="go">2      One   1.10   1.20</span>
<span class="go">2      Two   1.11   1.22</span>
</pre></div>
</div>
<div class="section" id="arithmetic">
<h3>Arithmetic<a class="headerlink" href="#arithmetic" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/19501510/divide-entire-pandas-multiindex-dataframe-by-dataframe-variable/19502176#19502176">Performing arithmetic with a MultiIndex that needs broadcasting</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [84]: </span><span class="n">cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="gp">   ....: </span>                                  <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">]])</span>
<span class="gp">   ....: </span>

<span class="gp">In [85]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

<span class="gp">In [86]: </span><span class="n">df</span>
<span class="gh">Out[86]: </span><span class="go"></span>
<span class="go">          A                   B                   C          </span>
<span class="go">          O         I         O         I         O         I</span>
<span class="go">n  1.920906 -0.388231 -2.314394  0.665508  0.402562  0.399555</span>
<span class="go">m -1.765956  0.850423  0.388054  0.992312  0.744086 -0.739776</span>

<span class="gp">In [87]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [88]: </span><span class="n">df</span>
<span class="gh">Out[88]: </span><span class="go"></span>
<span class="go">          A                   B              C     </span>
<span class="go">          O         I         O         I    O    I</span>
<span class="go">n  4.771702 -0.971660 -5.749162  1.665625  1.0  1.0</span>
<span class="go">m -2.373321 -1.149568  0.521518 -1.341367  1.0  1.0</span>
</pre></div>
</div>
</div>
<div class="section" id="slicing">
<h3>Slicing<a class="headerlink" href="#slicing" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/12590131/how-to-slice-multindex-columns-in-pandas-dataframes">Slicing a MultiIndex with xs</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [89]: </span><span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;AA&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;AA&#39;</span><span class="p">,</span> <span class="s1">&#39;six&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;BB&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;BB&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">),</span>
<span class="gp">   ....: </span>          <span class="p">(</span><span class="s1">&#39;BB&#39;</span><span class="p">,</span> <span class="s1">&#39;six&#39;</span><span class="p">)]</span>
<span class="gp">   ....: </span>

<span class="gp">In [90]: </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>

<span class="gp">In [91]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span> <span class="n">index</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MyData&#39;</span><span class="p">])</span>

<span class="gp">In [92]: </span><span class="n">df</span>
<span class="gh">Out[92]: </span><span class="go"></span>
<span class="go">        MyData</span>
<span class="go">AA one      11</span>
<span class="go">   six      22</span>
<span class="go">BB one      33</span>
<span class="go">   two      44</span>
<span class="go">   six      55</span>
</pre></div>
</div>
<p>To take the cross section of the 1st level and 1st axis the index:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Note : level and axis are optional, and default to zero</span>
<span class="gp">In [93]: </span><span class="n">df</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;BB&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gh">Out[93]: </span><span class="go"></span>
<span class="go">     MyData</span>
<span class="go">one      33</span>
<span class="go">two      44</span>
<span class="go">six      55</span>
</pre></div>
</div>
<p>…and now the 2nd level of the 1st axis.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [94]: </span><span class="n">df</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;six&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gh">Out[94]: </span><span class="go"></span>
<span class="go">    MyData</span>
<span class="go">AA      22</span>
<span class="go">BB      55</span>
</pre></div>
</div>
<p><a class="reference external" href="https://stackoverflow.com/questions/14964493/multiindex-based-indexing-in-pandas">Slicing a MultiIndex with xs, method #2</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [95]: </span><span class="kn">import</span> <span class="nn">itertools</span>

<span class="gp">In [96]: </span><span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="s1">&#39;Ada&#39;</span><span class="p">,</span> <span class="s1">&#39;Quinn&#39;</span><span class="p">,</span> <span class="s1">&#39;Violet&#39;</span><span class="p">],</span>
<span class="gp">   ....: </span>                               <span class="p">[</span><span class="s1">&#39;Comp&#39;</span><span class="p">,</span> <span class="s1">&#39;Math&#39;</span><span class="p">,</span> <span class="s1">&#39;Sci&#39;</span><span class="p">]))</span>
<span class="gp">   ....: </span>

<span class="gp">In [97]: </span><span class="n">headr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="s1">&#39;Exams&#39;</span><span class="p">,</span> <span class="s1">&#39;Labs&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;II&#39;</span><span class="p">]))</span>

<span class="gp">In [98]: </span><span class="n">indx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">,</span> <span class="s1">&#39;Course&#39;</span><span class="p">])</span>

<span class="gp">In [99]: </span><span class="n">cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">headr</span><span class="p">)</span>   <span class="c1"># Notice these are un-named</span>

<span class="gp">In [100]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">70</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>

<span class="gp">In [101]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indx</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>

<span class="gp">In [102]: </span><span class="n">df</span>
<span class="gh">Out[102]: </span><span class="go"></span>
<span class="go">               Exams     Labs    </span>
<span class="go">                   I  II    I  II</span>
<span class="go">Student Course                   </span>
<span class="go">Ada     Comp      70  71   72  73</span>
<span class="go">        Math      71  73   75  74</span>
<span class="go">        Sci       72  75   75  75</span>
<span class="go">Quinn   Comp      73  74   75  76</span>
<span class="go">        Math      74  76   78  77</span>
<span class="go">        Sci       75  78   78  78</span>
<span class="go">Violet  Comp      76  77   78  79</span>
<span class="go">        Math      77  79   81  80</span>
<span class="go">        Sci       78  81   81  81</span>

<span class="gp">In [103]: </span><span class="n">All</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

<span class="gp">In [104]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Violet&#39;</span><span class="p">]</span>
<span class="gh">Out[104]: </span><span class="go"></span>
<span class="go">       Exams     Labs    </span>
<span class="go">           I  II    I  II</span>
<span class="go">Course                   </span>
<span class="go">Comp      76  77   78  79</span>
<span class="go">Math      77  79   81  80</span>
<span class="go">Sci       78  81   81  81</span>

<span class="gp">In [105]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">All</span><span class="p">,</span> <span class="s1">&#39;Math&#39;</span><span class="p">),</span> <span class="n">All</span><span class="p">]</span>
<span class="go">                                                                                                                                                                       Out[105]: </span>
<span class="go">               Exams     Labs    </span>
<span class="go">                   I  II    I  II</span>
<span class="go">Student Course                   </span>
<span class="go">Ada     Math      71  73   75  74</span>
<span class="go">Quinn   Math      74  76   78  77</span>
<span class="go">Violet  Math      77  79   81  80</span>

<span class="gp">In [106]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;Ada&#39;</span><span class="p">,</span> <span class="s1">&#39;Quinn&#39;</span><span class="p">),</span> <span class="s1">&#39;Math&#39;</span><span class="p">),</span> <span class="n">All</span><span class="p">]</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                              Out[106]: </span>
<span class="go">               Exams     Labs    </span>
<span class="go">                   I  II    I  II</span>
<span class="go">Student Course                   </span>
<span class="go">Ada     Math      71  73   75  74</span>
<span class="go">Quinn   Math      74  76   78  77</span>

<span class="gp">In [107]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">All</span><span class="p">,</span> <span class="s1">&#39;Math&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Exams&#39;</span><span class="p">)]</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Out[107]: </span>
<span class="go">                 I  II</span>
<span class="go">Student Course        </span>
<span class="go">Ada     Math    71  73</span>
<span class="go">Quinn   Math    74  76</span>
<span class="go">Violet  Math    77  79</span>

<span class="gp">In [108]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">All</span><span class="p">,</span> <span class="s1">&#39;Math&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">All</span><span class="p">,</span> <span class="s1">&#39;II&#39;</span><span class="p">)]</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Out[108]: </span>
<span class="go">               Exams Labs</span>
<span class="go">                  II   II</span>
<span class="go">Student Course           </span>
<span class="go">Ada     Math      73   74</span>
<span class="go">Quinn   Math      76   77</span>
<span class="go">Violet  Math      79   80</span>
</pre></div>
</div>
<p><a class="reference external" href="https://stackoverflow.com/questions/19319432/pandas-selecting-a-lower-level-in-a-dataframe-to-do-a-ffill">Setting portions of a MultiIndex with xs</a></p>
</div>
<div class="section" id="sorting">
<h3>Sorting<a class="headerlink" href="#sorting" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/14733871/mutli-index-sorting-in-pandas">Sort by specific column or an ordered list of columns, with a MultiIndex</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [109]: </span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Labs&#39;</span><span class="p">,</span> <span class="s1">&#39;II&#39;</span><span class="p">),</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gh">Out[109]: </span><span class="go"></span>
<span class="go">               Exams     Labs    </span>
<span class="go">                   I  II    I  II</span>
<span class="go">Student Course                   </span>
<span class="go">Violet  Sci       78  81   81  81</span>
<span class="go">        Math      77  79   81  80</span>
<span class="go">        Comp      76  77   78  79</span>
<span class="go">Quinn   Sci       75  78   78  78</span>
<span class="go">        Math      74  76   78  77</span>
<span class="go">        Comp      73  74   75  76</span>
<span class="go">Ada     Sci       72  75   75  75</span>
<span class="go">        Math      71  73   75  74</span>
<span class="go">        Comp      70  71   72  73</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/pandas-dev/pandas/issues/2995">Partial Selection, the need for sortedness;</a></p>
</div>
<div class="section" id="levels">
<h3>Levels<a class="headerlink" href="#levels" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://stackoverflow.com/questions/14744068/prepend-a-level-to-a-pandas-multiindex">Prepending a level to a multiindex</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/14507794/python-pandas-how-to-flatten-a-hierarchical-index-in-columns">Flatten Hierarchical columns</a></p>
</div>
</div>
<div class="section" id="missing-data">
<span id="cookbook-missing-data"></span><h2>Missing Data<a class="headerlink" href="#missing-data" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="missing_data.html#missing-data"><span class="std std-ref">missing data</span></a> docs.</p>
<p>Fill forward a reversed timeseries</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [110]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">   .....: </span>                  <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2013-08-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">),</span>
<span class="gp">   .....: </span>                  <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">))</span>
<span class="gp">   .....: </span>

<span class="gp">In [111]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="gp">In [112]: </span><span class="n">df</span>
<span class="gh">Out[112]: </span><span class="go"></span>
<span class="go">                   A</span>
<span class="go">2013-08-01 -1.054874</span>
<span class="go">2013-08-02 -0.179642</span>
<span class="go">2013-08-05  0.639589</span>
<span class="go">2013-08-06       NaN</span>
<span class="go">2013-08-07  1.906684</span>
<span class="go">2013-08-08  0.104050</span>

<span class="gp">In [113]: </span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>
<span class="go">                                                                                                                                                              Out[113]: </span>
<span class="go">                   A</span>
<span class="go">2013-08-08  0.104050</span>
<span class="go">2013-08-07  1.906684</span>
<span class="go">2013-08-06  1.906684</span>
<span class="go">2013-08-05  0.639589</span>
<span class="go">2013-08-02 -0.179642</span>
<span class="go">2013-08-01 -1.054874</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/18196811/cumsum-reset-at-nan">cumsum reset at NaN values</a></p>
<div class="section" id="replace">
<h3>Replace<a class="headerlink" href="#replace" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://stackoverflow.com/questions/16818871/extracting-value-and-creating-new-column-out-of-it">Using replace with backrefs</a></p>
</div>
</div>
<div class="section" id="grouping">
<span id="cookbook-grouping"></span><h2>Grouping<a class="headerlink" href="#grouping" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="groupby.html#groupby"><span class="std std-ref">grouping</span></a> docs.</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15322632/python-pandas-df-groupy-agg-column-reference-in-agg">Basic grouping with apply</a></p>
<p>Unlike agg, apply’s callable is passed a sub-DataFrame which gives you access to all the columns</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [114]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;animal&#39;</span><span class="p">:</span> <span class="s1">&#39;cat dog cat fish dog cat cat&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;SSMMMLL&#39;</span><span class="p">),</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;adult&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">})</span>
<span class="gp">   .....: </span>

<span class="gp">In [115]: </span><span class="n">df</span>
<span class="gh">Out[115]: </span><span class="go"></span>
<span class="go">  animal size  weight  adult</span>
<span class="go">0    cat    S       8  False</span>
<span class="go">1    dog    S      10  False</span>
<span class="go">2    cat    M      11  False</span>
<span class="go">3   fish    M       1  False</span>
<span class="go">4    dog    M      20  False</span>
<span class="go">5    cat    L      12   True</span>
<span class="go">6    cat    L      12   True</span>

<span class="go"># List the size of the animals with the highest weight.</span>
<span class="gp">In [116]: </span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;animal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">subf</span><span class="p">:</span> <span class="n">subf</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">][</span><span class="n">subf</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()])</span>
<span class="go">                                                                                                                                                                                                                                                   Out[116]: </span>
<span class="go">animal</span>
<span class="go">cat     L</span>
<span class="go">dog     M</span>
<span class="go">fish    M</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/14734533/how-to-access-pandas-groupby-dataframe-by-key">Using get_group</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [117]: </span><span class="n">gb</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;animal&#39;</span><span class="p">])</span>

<span class="gp">In [118]: </span><span class="n">gb</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">)</span>
<span class="gh">Out[118]: </span><span class="go"></span>
<span class="go">  animal size  weight  adult</span>
<span class="go">0    cat    S       8  False</span>
<span class="go">2    cat    M      11  False</span>
<span class="go">5    cat    L      12   True</span>
<span class="go">6    cat    L      12   True</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/15262134/apply-different-functions-to-different-items-in-group-object-python-pandas">Apply to different items in a group</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [119]: </span><span class="k">def</span> <span class="nf">GrowUp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">avg_weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">avg_weight</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="mf">1.25</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">avg_weight</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">avg_weight</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">avg_weight</span><span class="p">,</span> <span class="bp">True</span><span class="p">],</span>
<span class="gp">   .....: </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;adult&#39;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [120]: </span><span class="n">expected_df</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">GrowUp</span><span class="p">)</span>

<span class="gp">In [121]: </span><span class="n">expected_df</span>
<span class="gh">Out[121]: </span><span class="go"></span>
<span class="go">       size   weight  adult</span>
<span class="go">animal                     </span>
<span class="go">cat       L  12.4375   True</span>
<span class="go">dog       L  20.0000   True</span>
<span class="go">fish      L   1.2500   True</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/14542145/reductions-down-a-column-in-pandas">Expanding Apply</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [122]: </span><span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">i</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)])</span>

<span class="gp">In [123]: </span><span class="k">def</span> <span class="nf">cum_ret</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [124]: </span><span class="k">def</span> <span class="nf">red</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">cum_ret</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [125]: </span><span class="n">S</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gh">Out[125]: </span><span class="go"></span>
<span class="go">0    1.010000</span>
<span class="go">1    1.030200</span>
<span class="go">2    1.061106</span>
<span class="go">3    1.103550</span>
<span class="go">4    1.158728</span>
<span class="go">5    1.228251</span>
<span class="go">6    1.314229</span>
<span class="go">7    1.419367</span>
<span class="go">8    1.547110</span>
<span class="go">9    1.701821</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/14760757/replacing-values-with-groupby-means">Replacing some values with mean of the rest of a group</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [126]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="gp">In [127]: </span><span class="n">gb</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>

<span class="gp">In [128]: </span><span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">mask</span> <span class="o">=</span> <span class="n">g</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="gp">   .....: </span>

<span class="gp">In [129]: </span><span class="n">gb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">replace</span><span class="p">)</span>
<span class="gh">Out[129]: </span><span class="go"></span>
<span class="go">     B</span>
<span class="go">0  1.0</span>
<span class="go">1 -1.0</span>
<span class="go">2  1.5</span>
<span class="go">3  1.5</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/14941366/pandas-sort-by-group-aggregate-and-column">Sort groups by aggregated data</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [130]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.62</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;flag&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">})</span>
<span class="gp">   .....: </span>

<span class="gp">In [131]: </span><span class="n">code_groups</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">)</span>

<span class="gp">In [132]: </span><span class="n">agg_n_sort_order</span> <span class="o">=</span> <span class="n">code_groups</span><span class="p">[[</span><span class="s1">&#39;data&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>

<span class="gp">In [133]: </span><span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">agg_n_sort_order</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="gp">In [134]: </span><span class="n">sorted_df</span>
<span class="gh">Out[134]: </span><span class="go"></span>
<span class="go">  code  data   flag</span>
<span class="go">1  bar -0.21   True</span>
<span class="go">4  bar -0.59  False</span>
<span class="go">0  foo  0.16  False</span>
<span class="go">3  foo  0.45   True</span>
<span class="go">2  baz  0.33  False</span>
<span class="go">5  baz  0.62   True</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/14897100/create-multiple-columns-in-pandas-aggregation-function">Create multiple aggregated columns</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [135]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2014-10-07&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;2min&#39;</span><span class="p">)</span>

<span class="gp">In [136]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

<span class="gp">In [137]: </span><span class="k">def</span> <span class="nf">MyCust</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<span class="gp">   .....: </span>        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.234</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">NaT</span>
<span class="gp">   .....: </span>

<span class="gp">In [138]: </span><span class="n">mhc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Mean&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="s1">&#39;Max&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="s1">&#39;Custom&#39;</span><span class="p">:</span> <span class="n">MyCust</span><span class="p">}</span>

<span class="gp">In [139]: </span><span class="n">ts</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;5min&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mhc</span><span class="p">)</span>
<span class="gh">Out[139]: </span><span class="go"></span>
<span class="go">Custom  2014-10-07 00:00:00    1.234</span>
<span class="go">        2014-10-07 00:05:00      NaT</span>
<span class="go">        2014-10-07 00:10:00    7.404</span>
<span class="go">        2014-10-07 00:15:00      NaT</span>
<span class="go">Max     2014-10-07 00:00:00        2</span>
<span class="go">        2014-10-07 00:05:00        4</span>
<span class="go">        2014-10-07 00:10:00        7</span>
<span class="go">        2014-10-07 00:15:00        9</span>
<span class="go">Mean    2014-10-07 00:00:00        1</span>
<span class="go">        2014-10-07 00:05:00      3.5</span>
<span class="go">        2014-10-07 00:10:00        6</span>
<span class="go">        2014-10-07 00:15:00      8.5</span>
<span class="go">dtype: object</span>

<span class="gp">In [140]: </span><span class="n">ts</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Out[140]: </span>
<span class="go">2014-10-07 00:00:00    0</span>
<span class="go">2014-10-07 00:02:00    1</span>
<span class="go">2014-10-07 00:04:00    2</span>
<span class="go">2014-10-07 00:06:00    3</span>
<span class="go">2014-10-07 00:08:00    4</span>
<span class="go">2014-10-07 00:10:00    5</span>
<span class="go">2014-10-07 00:12:00    6</span>
<span class="go">2014-10-07 00:14:00    7</span>
<span class="go">2014-10-07 00:16:00    8</span>
<span class="go">2014-10-07 00:18:00    9</span>
<span class="go">Freq: 2T, dtype: int64</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/17709270/i-want-to-create-a-column-of-value-counts-in-my-pandas-dataframe">Create a value counts column and reassign back to the DataFrame</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [141]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Color&#39;</span><span class="p">:</span> <span class="s1">&#39;Red Red Red Blue&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">]})</span>
<span class="gp">   .....: </span>

<span class="gp">In [142]: </span><span class="n">df</span>
<span class="gh">Out[142]: </span><span class="go"></span>
<span class="go">  Color  Value</span>
<span class="go">0   Red    100</span>
<span class="go">1   Red    150</span>
<span class="go">2   Red     50</span>
<span class="go">3  Blue     50</span>

<span class="gp">In [143]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Counts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Color&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>

<span class="gp">In [144]: </span><span class="n">df</span>
<span class="gh">Out[144]: </span><span class="go"></span>
<span class="go">  Color  Value  Counts</span>
<span class="go">0   Red    100       3</span>
<span class="go">1   Red    150       3</span>
<span class="go">2   Red     50       3</span>
<span class="go">3  Blue     50       1</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/q/23198053/190597">Shift groups of the values in a column based on the index</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [145]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;line_race&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;beyer&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">99</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">100</span><span class="p">]},</span>
<span class="gp">   .....: </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Last Gunfighter&#39;</span><span class="p">,</span> <span class="s1">&#39;Last Gunfighter&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                         <span class="s1">&#39;Last Gunfighter&#39;</span><span class="p">,</span> <span class="s1">&#39;Paynter&#39;</span><span class="p">,</span> <span class="s1">&#39;Paynter&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                         <span class="s1">&#39;Paynter&#39;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [146]: </span><span class="n">df</span>
<span class="gh">Out[146]: </span><span class="go"></span>
<span class="go">                 line_race  beyer</span>
<span class="go">Last Gunfighter         10     99</span>
<span class="go">Last Gunfighter         10    102</span>
<span class="go">Last Gunfighter          8    103</span>
<span class="go">Paynter                 10    103</span>
<span class="go">Paynter                 10     88</span>
<span class="go">Paynter                  8    100</span>

<span class="gp">In [147]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;beyer_shifted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;beyer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [148]: </span><span class="n">df</span>
<span class="gh">Out[148]: </span><span class="go"></span>
<span class="go">                 line_race  beyer  beyer_shifted</span>
<span class="go">Last Gunfighter         10     99            NaN</span>
<span class="go">Last Gunfighter         10    102           99.0</span>
<span class="go">Last Gunfighter          8    103          102.0</span>
<span class="go">Paynter                 10    103            NaN</span>
<span class="go">Paynter                 10     88          103.0</span>
<span class="go">Paynter                  8    100           88.0</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/q/26701849/190597">Select row with maximum value from each group</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [149]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;that&#39;</span><span class="p">,</span> <span class="s1">&#39;this&#39;</span><span class="p">,</span> <span class="s1">&#39;this&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mail&#39;</span><span class="p">,</span> <span class="s1">&#39;web&#39;</span><span class="p">,</span> <span class="s1">&#39;mail&#39;</span><span class="p">,</span> <span class="s1">&#39;mail&#39;</span><span class="p">,</span> <span class="s1">&#39;web&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;host&#39;</span><span class="p">,</span> <span class="s1">&#39;service&#39;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [150]: </span><span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;idxmax&#39;</span><span class="p">)</span>

<span class="gp">In [151]: </span><span class="n">df_count</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="gp">In [152]: </span><span class="n">df_count</span>
<span class="gh">Out[152]: </span><span class="go"></span>
<span class="go">    host service  no</span>
<span class="go">0  other     web   2</span>
<span class="go">1   that    mail   1</span>
<span class="go">2   this    mail   2</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/q/29142487/846892">Grouping like Python’s itertools.groupby</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [153]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>

<span class="gp">In [154]: </span><span class="n">df</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">groupby</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">A</span> <span class="o">!=</span> <span class="n">df</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span><span class="o">.</span><span class="n">groups</span>
<span class="gh">Out[154]: </span><span class="go"></span>
<span class="go">{1: Int64Index([0], dtype=&#39;int64&#39;),</span>
<span class="go"> 2: Int64Index([1], dtype=&#39;int64&#39;),</span>
<span class="go"> 3: Int64Index([2], dtype=&#39;int64&#39;),</span>
<span class="go"> 4: Int64Index([3, 4, 5], dtype=&#39;int64&#39;),</span>
<span class="go"> 5: Int64Index([6], dtype=&#39;int64&#39;),</span>
<span class="go"> 6: Int64Index([7, 8], dtype=&#39;int64&#39;)}</span>

<span class="gp">In [155]: </span><span class="n">df</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">groupby</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">A</span> <span class="o">!=</span> <span class="n">df</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="go">                                                                                                                                                                                                                                            Out[155]: </span>
<span class="go">0    0</span>
<span class="go">1    1</span>
<span class="go">2    0</span>
<span class="go">3    1</span>
<span class="go">4    2</span>
<span class="go">5    3</span>
<span class="go">6    0</span>
<span class="go">7    1</span>
<span class="go">8    2</span>
<span class="go">Name: A, dtype: int64</span>
</pre></div>
</div>
<div class="section" id="expanding-data">
<h3>Expanding Data<a class="headerlink" href="#expanding-data" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://stackoverflow.com/questions/15489011/python-time-series-alignment-and-to-date-functions">Alignment and to-date</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/14300768/pandas-rolling-computation-with-window-based-on-values-instead-of-counts">Rolling Computation window based on values instead of counts</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15771472/pandas-rolling-mean-by-time-interval">Rolling Mean by Time Interval</a></p>
</div>
<div class="section" id="id2">
<h3>Splitting<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://stackoverflow.com/questions/13353233/best-way-to-split-a-dataframe-given-an-edge/15449992#15449992">Splitting a frame</a></p>
<p>Create a list of dataframes, split using a delineation based on logic included in rows.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [156]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Case&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                                 <span class="s1">&#39;A&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                        <span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">9</span><span class="p">)})</span>
<span class="gp">   .....: </span>

<span class="gp">In [157]: </span><span class="n">dfs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">((</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Case&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="gp">   .....: </span>               <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">())))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">   .....: </span>

<span class="gp">In [158]: </span><span class="n">dfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gh">Out[158]: </span><span class="go"></span>
<span class="go">  Case      Data</span>
<span class="go">0    A  0.174068</span>
<span class="go">1    A -0.439461</span>
<span class="go">2    A -0.741343</span>
<span class="go">3    B -0.079673</span>

<span class="gp">In [159]: </span><span class="n">dfs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">                                                                                                Out[159]: </span>
<span class="go">  Case      Data</span>
<span class="go">4    A -0.922875</span>
<span class="go">5    A  0.303638</span>
<span class="go">6    B -0.917368</span>

<span class="gp">In [160]: </span><span class="n">dfs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">                                                                                                                                                                               Out[160]: </span>
<span class="go">  Case      Data</span>
<span class="go">7    A -1.624062</span>
<span class="go">8    A -0.758514</span>
</pre></div>
</div>
</div>
<div class="section" id="pivot">
<span id="cookbook-pivot"></span><h3>Pivot<a class="headerlink" href="#pivot" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="reshaping.html#reshaping-pivot"><span class="std std-ref">Pivot</span></a> docs.</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15570099/pandas-pivot-tables-row-subtotals/15574875#15574875">Partial sums and subtotals</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [161]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Province&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ON&#39;</span><span class="p">,</span> <span class="s1">&#39;QC&#39;</span><span class="p">,</span> <span class="s1">&#39;BC&#39;</span><span class="p">,</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;MN&#39;</span><span class="p">,</span> <span class="s1">&#39;ON&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                        <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Toronto&#39;</span><span class="p">,</span> <span class="s1">&#39;Montreal&#39;</span><span class="p">,</span> <span class="s1">&#39;Vancouver&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                                 <span class="s1">&#39;Calgary&#39;</span><span class="p">,</span> <span class="s1">&#39;Edmonton&#39;</span><span class="p">,</span> <span class="s1">&#39;Winnipeg&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                                 <span class="s1">&#39;Windsor&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                        <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">   .....: </span>

<span class="gp">In [162]: </span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Province&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [163]: </span><span class="n">table</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;City&#39;</span><span class="p">)</span>
<span class="gh">Out[163]: </span><span class="go"></span>
<span class="go">                    Sales</span>
<span class="go">Province City            </span>
<span class="go">AL       All         12.0</span>
<span class="go">         Calgary      8.0</span>
<span class="go">         Edmonton     4.0</span>
<span class="go">BC       All         16.0</span>
<span class="go">         Vancouver   16.0</span>
<span class="go">MN       All          3.0</span>
<span class="go">         Winnipeg     3.0</span>
<span class="go">...                   ...</span>
<span class="go">All      Calgary      8.0</span>
<span class="go">         Edmonton     4.0</span>
<span class="go">         Montreal     6.0</span>
<span class="go">         Toronto     13.0</span>
<span class="go">         Vancouver   16.0</span>
<span class="go">         Windsor      1.0</span>
<span class="go">         Winnipeg     3.0</span>

<span class="go">[20 rows x 1 columns]</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/15589354/frequency-tables-in-pandas-like-plyr-in-r">Frequency table like plyr in R</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [164]: </span><span class="n">grades</span> <span class="o">=</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">78</span><span class="p">]</span>

<span class="gp">In [165]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;Gender&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                              <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;ExamYear&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2007&#39;</span><span class="p">,</span> <span class="s1">&#39;2007&#39;</span><span class="p">,</span> <span class="s1">&#39;2007&#39;</span><span class="p">,</span> <span class="s1">&#39;2008&#39;</span><span class="p">,</span> <span class="s1">&#39;2008&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                                <span class="s1">&#39;2008&#39;</span><span class="p">,</span> <span class="s1">&#39;2008&#39;</span><span class="p">,</span> <span class="s1">&#39;2009&#39;</span><span class="p">,</span> <span class="s1">&#39;2009&#39;</span><span class="p">,</span> <span class="s1">&#39;2009&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;Class&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;algebra&#39;</span><span class="p">,</span> <span class="s1">&#39;stats&#39;</span><span class="p">,</span> <span class="s1">&#39;bio&#39;</span><span class="p">,</span> <span class="s1">&#39;algebra&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                             <span class="s1">&#39;algebra&#39;</span><span class="p">,</span> <span class="s1">&#39;stats&#39;</span><span class="p">,</span> <span class="s1">&#39;stats&#39;</span><span class="p">,</span> <span class="s1">&#39;algebra&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                             <span class="s1">&#39;bio&#39;</span><span class="p">,</span> <span class="s1">&#39;bio&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;Participated&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span>
<span class="gp">   .....: </span>                                    <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;Passed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">50</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grades</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;Employed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span>
<span class="gp">   .....: </span>                                <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;Grade&#39;</span><span class="p">:</span> <span class="n">grades</span><span class="p">})</span>
<span class="gp">   .....: </span>

<span class="gp">In [166]: </span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ExamYear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;Participated&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="s1">&#39;yes&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                            <span class="s1">&#39;Passed&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">),</span>
<span class="gp">   .....: </span>                            <span class="s1">&#39;Employed&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
<span class="gp">   .....: </span>                            <span class="s1">&#39;Grade&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)})</span>
<span class="gp">   .....: </span>
<span class="gh">Out[166]: </span><span class="go"></span>
<span class="go">          Participated  Passed  Employed      Grade</span>
<span class="go">ExamYear                                           </span>
<span class="go">2007                 3       2         3  74.000000</span>
<span class="go">2008                 3       3         0  68.500000</span>
<span class="go">2009                 3       2         2  60.666667</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/30379789/plot-pandas-data-frame-with-year-over-year-data">Plot pandas DataFrame with year over year data</a></p>
<p>To create year and month cross tabulation:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [167]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">36</span><span class="p">)},</span>
<span class="gp">   .....: </span>                  <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2011-01-01&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">36</span><span class="p">))</span>
<span class="gp">   .....: </span>

<span class="gp">In [168]: </span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
<span class="gp">   .....: </span>               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gh">Out[168]: </span><span class="go"></span>
<span class="go">        2011      2012      2013</span>
<span class="go">1  -0.560859  0.120930  0.516870</span>
<span class="go">2  -0.589005 -0.210518  0.343125</span>
<span class="go">3  -1.070678 -0.931184  2.137827</span>
<span class="go">4  -1.681101  0.240647  0.452429</span>
<span class="go">5   0.403776 -0.027462  0.483103</span>
<span class="go">6   0.609862  0.033113  0.061495</span>
<span class="go">7   0.387936 -0.658418  0.240767</span>
<span class="go">8   1.815066  0.324102  0.782413</span>
<span class="go">9   0.705200 -1.403048  0.628462</span>
<span class="go">10 -0.668049 -0.581967 -0.880627</span>
<span class="go">11  0.242501 -1.233862  0.777575</span>
<span class="go">12  0.313421 -3.520876 -0.779367</span>
</pre></div>
</div>
</div>
<div class="section" id="apply">
<h3>Apply<a class="headerlink" href="#apply" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://stackoverflow.com/questions/17349981/converting-pandas-dataframe-with-categorical-values-into-binary-values">Rolling Apply to Organize - Turning embedded lists into a MultiIndex frame</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [169]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]],</span>
<span class="gp">   .....: </span>                        <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;jj&#39;</span><span class="p">,</span> <span class="s1">&#39;kk&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;ccc&#39;</span><span class="p">]]},</span>
<span class="gp">   .....: </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;II&#39;</span><span class="p">,</span> <span class="s1">&#39;III&#39;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [170]: </span><span class="k">def</span> <span class="nf">SeriesFromSubList</span><span class="p">(</span><span class="n">aList</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">aList</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [171]: </span><span class="n">df_orgz</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">({</span><span class="n">ind</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">SeriesFromSubList</span><span class="p">)</span>
<span class="gp">   .....: </span>                     <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()})</span>
<span class="gp">   .....: </span>

<span class="gp">In [172]: </span><span class="n">df_orgz</span>
<span class="gh">Out[172]: </span><span class="go"></span>
<span class="go">         0    1    2     3</span>
<span class="go">I   A    2    4    8  16.0</span>
<span class="go">    B    a    b    c   NaN</span>
<span class="go">II  A  100  200  NaN   NaN</span>
<span class="go">    B   jj   kk  NaN   NaN</span>
<span class="go">III A   10   20   30   NaN</span>
<span class="go">    B  ccc  NaN  NaN   NaN</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/19121854/using-rolling-apply-on-a-dataframe-object">Rolling Apply with a DataFrame returning a Series</a></p>
<p>Rolling Apply to multiple columns where function calculates a Series before a Scalar from the Series is returned</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [173]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">,</span>
<span class="gp">   .....: </span>                  <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">2000</span><span class="p">),</span>
<span class="gp">   .....: </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [174]: </span><span class="n">df</span>
<span class="gh">Out[174]: </span><span class="go"></span>
<span class="go">                   A         B</span>
<span class="go">2001-01-01  0.000032 -0.000004</span>
<span class="go">2001-01-02 -0.000001  0.000207</span>
<span class="go">2001-01-03  0.000120 -0.000220</span>
<span class="go">2001-01-04 -0.000083 -0.000165</span>
<span class="go">2001-01-05 -0.000047  0.000156</span>
<span class="go">2001-01-06  0.000027  0.000104</span>
<span class="go">2001-01-07  0.000041 -0.000101</span>
<span class="go">...              ...       ...</span>
<span class="go">2006-06-17 -0.000034  0.000034</span>
<span class="go">2006-06-18  0.000002  0.000166</span>
<span class="go">2006-06-19  0.000023 -0.000081</span>
<span class="go">2006-06-20 -0.000061  0.000012</span>
<span class="go">2006-06-21 -0.000111  0.000027</span>
<span class="go">2006-06-22 -0.000061 -0.000009</span>
<span class="go">2006-06-23  0.000074 -0.000138</span>

<span class="go">[2000 rows x 2 columns]</span>

<span class="gp">In [175]: </span><span class="k">def</span> <span class="nf">gm</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">const</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">v</span> <span class="o">=</span> <span class="p">((((</span><span class="n">df</span><span class="o">.</span><span class="n">A</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">   .....: </span>

<span class="gp">In [176]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">gm</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">51</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">   .....: </span>               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)})</span>
<span class="gp">   .....: </span>

<span class="gp">In [177]: </span><span class="n">s</span>
<span class="gh">Out[177]: </span><span class="go"></span>
<span class="go">2001-01-01   -0.001373</span>
<span class="go">2001-01-02   -0.001705</span>
<span class="go">2001-01-03   -0.002885</span>
<span class="go">2001-01-04   -0.002987</span>
<span class="go">2001-01-05   -0.002384</span>
<span class="go">2001-01-06   -0.004700</span>
<span class="go">2001-01-07   -0.005500</span>
<span class="go">                ...   </span>
<span class="go">2006-04-28   -0.002682</span>
<span class="go">2006-04-29   -0.002436</span>
<span class="go">2006-04-30   -0.002602</span>
<span class="go">2006-05-01   -0.001785</span>
<span class="go">2006-05-02   -0.001799</span>
<span class="go">2006-05-03   -0.000605</span>
<span class="go">2006-05-04   -0.000541</span>
<span class="go">Length: 1950, dtype: float64</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/21040766/python-pandas-rolling-apply-two-column-input-into-function/21045831#21045831">Rolling apply with a DataFrame returning a Scalar</a></p>
<p>Rolling Apply to multiple columns where function returns a Scalar (Volume Weighted Average Price)</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [178]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2014-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="gp">In [179]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Open&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">)),</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;Close&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">)),</span>
<span class="gp">   .....: </span>                   <span class="s1">&#39;Volume&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">))},</span>
<span class="gp">   .....: </span>                  <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [180]: </span><span class="n">df</span>
<span class="gh">Out[180]: </span><span class="go"></span>
<span class="go">                Open     Close  Volume</span>
<span class="go">2014-01-01  0.011174 -0.653039    1581</span>
<span class="go">2014-01-02  0.214258  1.314205    1707</span>
<span class="go">2014-01-03 -1.046922 -0.341915    1768</span>
<span class="go">2014-01-04 -0.752902 -1.303586     836</span>
<span class="go">2014-01-05 -0.410793  0.396288     694</span>
<span class="go">2014-01-06  0.648401 -0.548006     796</span>
<span class="go">2014-01-07  0.737320  0.481380     265</span>
<span class="go">...              ...       ...     ...</span>
<span class="go">2014-04-04  0.120378 -2.548128     564</span>
<span class="go">2014-04-05  0.231661  0.223346    1908</span>
<span class="go">2014-04-06  0.952664  1.228841    1090</span>
<span class="go">2014-04-07 -0.176090  0.552784    1813</span>
<span class="go">2014-04-08  1.781318 -0.795389    1103</span>
<span class="go">2014-04-09 -0.753493 -0.018815    1456</span>
<span class="go">2014-04-10 -1.047997  1.138197    1193</span>

<span class="go">[100 rows x 3 columns]</span>

<span class="gp">In [181]: </span><span class="k">def</span> <span class="nf">vwap</span><span class="p">(</span><span class="n">bars</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="p">((</span><span class="n">bars</span><span class="o">.</span><span class="n">Close</span> <span class="o">*</span> <span class="n">bars</span><span class="o">.</span><span class="n">Volume</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">bars</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">   .....: </span>

<span class="gp">In [182]: </span><span class="n">window</span> <span class="o">=</span> <span class="mi">5</span>

<span class="gp">In [183]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">vwap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window</span><span class="p">]),</span>
<span class="gp">   .....: </span>                <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window</span><span class="p">]]))</span>
<span class="gp">   .....: </span>               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">window</span><span class="p">)])</span>
<span class="gp">   .....: </span>

<span class="gp">In [184]: </span><span class="n">s</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[184]: </span><span class="go"></span>
<span class="go">2014-01-06   -0.03</span>
<span class="go">2014-01-07    0.07</span>
<span class="go">2014-01-08   -0.40</span>
<span class="go">2014-01-09   -0.81</span>
<span class="go">2014-01-10   -0.63</span>
<span class="go">2014-01-11   -0.86</span>
<span class="go">2014-01-12   -0.36</span>
<span class="go">              ... </span>
<span class="go">2014-04-04   -1.27</span>
<span class="go">2014-04-05   -1.36</span>
<span class="go">2014-04-06   -0.73</span>
<span class="go">2014-04-07    0.04</span>
<span class="go">2014-04-08    0.21</span>
<span class="go">2014-04-09    0.07</span>
<span class="go">2014-04-10    0.25</span>
<span class="go">Length: 95, dtype: float64</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="timeseries">
<h2>Timeseries<a class="headerlink" href="#timeseries" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://stackoverflow.com/questions/14539992/pandas-drop-rows-outside-of-time-range">Between times</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/17559885/pandas-dataframe-mask-based-on-index">Using indexer between time</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/24010830/pandas-generate-sequential-timestamp-with-jump/24014440#24014440?">Constructing a datetime range that excludes weekends and includes only certain times</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/13893227/vectorized-look-up-of-values-in-pandas-dataframe">Vectorized Lookup</a></p>
<p><a class="reference external" href="http://nipunbatra.github.io/2015/06/timeseries/">Aggregation and plotting time series</a></p>
<p>Turn a matrix with hours in columns and days in rows into a continuous row sequence in the form of a time series.
<a class="reference external" href="http://stackoverflow.com/questions/15432659/how-to-rearrange-a-python-pandas-dataframe">How to rearrange a Python pandas DataFrame?</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/22244383/pandas-df-refill-adding-two-columns-of-different-shape">Dealing with duplicates when reindexing a timeseries to a specified frequency</a></p>
<p>Calculate the first day of the month for each entry in a DatetimeIndex</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [185]: </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [186]: </span><span class="n">dates</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span>
<span class="gh">Out[186]: </span><span class="go"></span>
<span class="go">DatetimeIndex([&#39;2000-01-01&#39;, &#39;2000-01-01&#39;, &#39;2000-01-01&#39;, &#39;2000-01-01&#39;,</span>
<span class="go">               &#39;2000-01-01&#39;],</span>
<span class="go">              dtype=&#39;datetime64[ns]&#39;, freq=None)</span>
</pre></div>
</div>
<div class="section" id="resampling">
<span id="cookbook-resample"></span><h3>Resampling<a class="headerlink" href="#resampling" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="timeseries.html#timeseries-resampling"><span class="std std-ref">Resample</span></a> docs.</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/15297053/how-can-i-divide-single-values-of-a-dataframe-by-monthly-averages">Using Grouper instead of TimeGrouper for time grouping of values</a></p>
<p><a class="reference external" href="https://stackoverflow.com/questions/33637312/pandas-grouper-by-frequency-with-completeness-requirement">Time grouping with some missing values</a></p>
<p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/timeseries.html#offset-aliases">Valid frequency arguments to Grouper</a></p>
<p><a class="reference external" href="https://stackoverflow.com/questions/41483763/pandas-timegrouper-on-multiindex">Grouping using a MultiIndex</a></p>
<p><a class="reference external" href="https://github.com/pandas-dev/pandas/issues/3791">Using TimeGrouper and another grouping to create subgroups, then apply a custom function</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15408156/resampling-with-custom-periods">Resampling with custom periods</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/14898574/resample-intrday-pandas-dataframe-without-add-new-days">Resample intraday frame without adding new days</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/14861023/resampling-minute-data">Resample minute data</a></p>
<p><a class="reference external" href="http://stackoverflow.com/q/18677271/564538">Resample with groupby</a></p>
</div>
</div>
<div class="section" id="merge">
<span id="cookbook-merge"></span><h2>Merge<a class="headerlink" href="#merge" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="merging.html#merging-concatenation"><span class="std std-ref">Concat</span></a> docs. The <a class="reference internal" href="merging.html#merging-join"><span class="std std-ref">Join</span></a> docs.</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/14988480/pandas-version-of-rbind">Append two dataframes with overlapping index (emulate R rbind)</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [187]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="gp">In [188]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>

<span class="gp">In [189]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>Depending on df construction, <code class="docutils literal notranslate"><span class="pre">ignore_index</span></code> may be needed</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [190]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [191]: </span><span class="n">df</span>
<span class="gh">Out[191]: </span><span class="go"></span>
<span class="go">           A         B         C</span>
<span class="go">0  -0.480676 -1.305282 -0.212846</span>
<span class="go">1   1.979901  0.363112 -0.275732</span>
<span class="go">2  -1.433852  0.580237 -0.013672</span>
<span class="go">3   1.776623 -0.803467  0.521517</span>
<span class="go">4  -0.302508 -0.442948 -0.395768</span>
<span class="go">5  -0.249024 -0.031510  2.413751</span>
<span class="go">6  -0.480676 -1.305282 -0.212846</span>
<span class="go">7   1.979901  0.363112 -0.275732</span>
<span class="go">8  -1.433852  0.580237 -0.013672</span>
<span class="go">9   1.776623 -0.803467  0.521517</span>
<span class="go">10 -0.302508 -0.442948 -0.395768</span>
<span class="go">11 -0.249024 -0.031510  2.413751</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/pandas-dev/pandas/issues/2996">Self Join of a DataFrame</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [192]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Area&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">   .....: </span>                        <span class="s1">&#39;Bins&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">110</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">[</span><span class="mi">160</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">[</span><span class="mi">40</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">   .....: </span>                        <span class="s1">&#39;Test_0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">   .....: </span>                        <span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">7</span><span class="p">)})</span>
<span class="gp">   .....: </span>

<span class="gp">In [193]: </span><span class="n">df</span>
<span class="gh">Out[193]: </span><span class="go"></span>
<span class="go">  Area  Bins  Test_0      Data</span>
<span class="go">0    A   110       0 -0.378914</span>
<span class="go">1    A   110       1 -1.032527</span>
<span class="go">2    A   160       0 -1.402816</span>
<span class="go">3    A   160       1  0.715333</span>
<span class="go">4    A   160       2 -0.091438</span>
<span class="go">5    C    40       0  1.608418</span>
<span class="go">6    C    40       1  0.753207</span>

<span class="gp">In [194]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Test_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Test_0&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>

<span class="gp">In [195]: </span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">,</span> <span class="s1">&#39;Area&#39;</span><span class="p">,</span> <span class="s1">&#39;Test_0&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>         <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">,</span> <span class="s1">&#39;Area&#39;</span><span class="p">,</span> <span class="s1">&#39;Test_1&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>         <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_L&#39;</span><span class="p">,</span> <span class="s1">&#39;_R&#39;</span><span class="p">))</span>
<span class="gp">   .....: </span>
<span class="gh">Out[195]: </span><span class="go"></span>
<span class="go">  Area  Bins  Test_0_L    Data_L  Test_1_L  Test_0_R    Data_R  Test_1_R</span>
<span class="go">0    A   110         0 -0.378914        -1         1 -1.032527         0</span>
<span class="go">1    A   160         0 -1.402816        -1         1  0.715333         0</span>
<span class="go">2    A   160         1  0.715333         0         2 -0.091438         1</span>
<span class="go">3    C    40         0  1.608418        -1         1  0.753207         0</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/14341805/pandas-merge-pd-merge-how-to-set-the-index-and-join">How to set the index and join</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/12322289/kdb-like-asof-join-for-timeseries-data-in-pandas/12336039#12336039">KDB like asof join</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15581829/how-to-perform-an-inner-or-outer-join-of-dataframes-with-pandas-on-non-simplisti">Join with a criteria based on the values</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/25125626/pandas-merge-with-logic/2512764">Using searchsorted to merge based on values inside a range</a></p>
</div>
<div class="section" id="plotting">
<span id="cookbook-plotting"></span><h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="visualization.html#visualization"><span class="std std-ref">Plotting</span></a> docs.</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/14349055/making-matplotlib-graphs-look-like-r-by-default">Make Matplotlib look like R</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/12945971/pandas-timeseries-plot-setting-x-axis-major-and-minor-ticks-and-labels">Setting x-axis major and minor labels</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16392921/make-more-than-one-chart-in-same-ipython-notebook-cell">Plotting multiple charts in an ipython notebook</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16568964/make-a-multiline-plot-from-csv-file-in-matplotlib">Creating a multi-line plot</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/17050202/plot-timeseries-of-histograms-in-python">Plotting a heatmap</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/11067368/annotate-time-series-plot-in-matplotlib">Annotate a time-series plot</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/17891493/annotating-points-from-a-pandas-dataframe-in-matplotlib-plot">Annotate a time-series plot #2</a></p>
<p><a class="reference external" href="https://pandas-xlsxwriter-charts.readthedocs.io/">Generate Embedded plots in excel files using Pandas, Vincent and xlsxwriter</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/23232989/boxplot-stratified-by-column-in-python-pandas">Boxplot for each quartile of a stratifying variable</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [196]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span><span class="s1">&#39;stratifying_var&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
<span class="gp">   .....: </span>     <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)})</span>
<span class="gp">   .....: </span>

<span class="gp">In [197]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;quartiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;stratifying_var&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>    <span class="mi">4</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0-25%&#39;</span><span class="p">,</span> <span class="s1">&#39;25-50%&#39;</span><span class="p">,</span> <span class="s1">&#39;50-75%&#39;</span><span class="p">,</span> <span class="s1">&#39;75-100%&#39;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [198]: </span><span class="n">df</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;quartiles&#39;</span><span class="p">)</span>
<span class="gh">Out[198]: </span><span class="go">&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f380fe70e48&gt;</span>
</pre></div>
</div>
<img alt="../_images/quartile_boxplot.png" src="../_images/quartile_boxplot.png" />
</div>
<div class="section" id="data-in-out">
<h2>Data In/Out<a class="headerlink" href="#data-in-out" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://stackoverflow.com/questions/16628329/hdf5-and-sqlite-concurrency-compression-i-o-performance">Performance comparison of SQL vs HDF5</a></p>
<div class="section" id="csv">
<span id="cookbook-csv"></span><h3>CSV<a class="headerlink" href="#csv" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="io.html#io-read-csv-table"><span class="std std-ref">CSV</span></a> docs</p>
<p><a class="reference external" href="http://wesmckinney.com/blog/update-on-upcoming-pandas-v0-10-new-file-parser-other-performance-wins/">read_csv in action</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/17134942/pandas-dataframe-output-end-of-csv">appending to a csv</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/11622652/large-persistent-dataframe-in-pandas/12193309#12193309">Reading a csv chunk-by-chunk</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/19674212/pandas-data-frame-select-rows-and-clear-memory">Reading only certain rows of a csv chunk-by-chunk</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15008970/way-to-read-first-few-lines-for-pandas-dataframe">Reading the first few lines of a frame</a></p>
<p>Reading a file that is compressed but not by <code class="docutils literal notranslate"><span class="pre">gzip/bz2</span></code> (the native compressed formats which <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> understands).
This example shows a <code class="docutils literal notranslate"><span class="pre">WinZipped</span></code> file, but is a general application of opening the file within a context manager and
using that handle to read.
<a class="reference external" href="http://stackoverflow.com/questions/17789907/pandas-convert-winzipped-csv-file-to-data-frame">See here</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15555005/get-inferred-dataframe-types-iteratively-using-chunksize">Inferring dtypes from a file</a></p>
<p><a class="reference external" href="http://github.com/pandas-dev/pandas/issues/2886">Dealing with bad lines</a></p>
<p><a class="reference external" href="http://nipunbatra.github.io/2013/06/reading-unclean-data-csv-using-pandas/">Dealing with bad lines II</a></p>
<p><a class="reference external" href="http://nipunbatra.github.io/2013/06/pandas-reading-csv-with-unix-timestamps-and-converting-to-local-timezone/">Reading CSV with Unix timestamps and converting to local timezone</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/17349574/pandas-write-multiindex-rows-with-to-csv">Write a multi-row index CSV without writing duplicates</a></p>
<div class="section" id="reading-multiple-files-to-create-a-single-dataframe">
<span id="cookbook-csv-multiple-files"></span><h4>Reading multiple files to create a single DataFrame<a class="headerlink" href="#reading-multiple-files-to-create-a-single-dataframe" title="Permalink to this headline">¶</a></h4>
<p>The best way to combine multiple files into a single DataFrame is to read the individual frames one by one, put all
of the individual frames into a list, and then combine the frames in the list using <code class="xref py py-func docutils literal notranslate"><span class="pre">pd.concat()</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [199]: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">   .....: </span>    <span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;file_{}.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="gp">   .....: </span>

<span class="gp">In [200]: </span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;file_0.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;file_1.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;file_2.csv&#39;</span><span class="p">]</span>

<span class="gp">In [201]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use the same approach to read all files matching a pattern.  Here is an example using <code class="docutils literal notranslate"><span class="pre">glob</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [202]: </span><span class="kn">import</span> <span class="nn">glob</span>

<span class="gp">In [203]: </span><span class="kn">import</span> <span class="nn">os</span>

<span class="gp">In [204]: </span><span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;file_*.csv&#39;</span><span class="p">)</span>

<span class="gp">In [205]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, this strategy will work with the other <code class="docutils literal notranslate"><span class="pre">pd.read_*(...)</span></code> functions described in the <a class="reference internal" href="io.html#io"><span class="std std-ref">io docs</span></a>.</p>
</div>
<div class="section" id="parsing-date-components-in-multi-columns">
<h4>Parsing date components in multi-columns<a class="headerlink" href="#parsing-date-components-in-multi-columns" title="Permalink to this headline">¶</a></h4>
<p>Parsing date components in multi-columns is faster with a format</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [206]: </span><span class="n">i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20000101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="gp">In [207]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">day</span><span class="p">})</span>

<span class="gp">In [208]: </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[208]: </span><span class="go"></span>
<span class="go">   year  month  day</span>
<span class="go">0  2000      1    1</span>
<span class="go">1  2000      1    2</span>
<span class="go">2  2000      1    3</span>
<span class="go">3  2000      1    4</span>
<span class="go">4  2000      1    5</span>

<span class="gp">In [209]: </span><span class="o">%</span><span class="k">timeit</span> pd.to_datetime(df.year * 10000 + df.month * 100 + df.day, format=&#39;%Y%m%d&#39;)
<span class="gp">   .....: </span><span class="n">ds</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%04d%02d%02d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                                          <span class="n">x</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">   .....: </span><span class="n">ds</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gp">   .....: </span><span class="o">%</span><span class="k">timeit</span> pd.to_datetime(ds)
<span class="gp">   .....: </span>
<span class="go">                                                                                                                                   5.63 ms +- 140 us per loop (mean +- std. dev. of 7 runs, 100 loops each)</span>
<span class="go">1.76 ms +- 119 us per loop (mean +- std. dev. of 7 runs, 1000 loops each)</span>
</pre></div>
</div>
</div>
<div class="section" id="skip-row-between-header-and-data">
<h4>Skip row between header and data<a class="headerlink" href="#skip-row-between-header-and-data" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [210]: </span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2">;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2">;;;;</span>
<span class="gp">   .....: </span><span class="s2">date;Param1;Param2;Param4;Param5</span>
<span class="gp">   .....: </span><span class="s2">    ;m²;°C;m²;m</span>
<span class="gp">   .....: </span><span class="s2">;;;;</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 00:00;1;1;2;3</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 01:00;5;3;4;5</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 02:00;9;5;6;7</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 03:00;13;7;8;9</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 04:00;17;9;10;11</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 05:00;21;11;12;13</span>
<span class="gp">   .....: </span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">   .....: </span>
</pre></div>
</div>
<div class="section" id="option-1-pass-rows-explicitly-to-skip-rows">
<h5>Option 1: pass rows explicitly to skip rows<a class="headerlink" href="#option-1-pass-rows-explicitly-to-skip-rows" title="Permalink to this headline">¶</a></h5>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [211]: </span><span class="kn">from</span> <span class="nn">pandas.compat</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="gp">In [212]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
<span class="gp">   .....: </span>            <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gh">Out[212]: </span><span class="go"></span>
<span class="go">                     Param1  Param2  Param4  Param5</span>
<span class="go">date                                               </span>
<span class="go">1990-01-01 00:00:00       1       1       2       3</span>
<span class="go">1990-01-01 01:00:00       5       3       4       5</span>
<span class="go">1990-01-01 02:00:00       9       5       6       7</span>
<span class="go">1990-01-01 03:00:00      13       7       8       9</span>
<span class="go">1990-01-01 04:00:00      17       9      10      11</span>
<span class="go">1990-01-01 05:00:00      21      11      12      13</span>
</pre></div>
</div>
</div>
<div class="section" id="option-2-read-column-names-and-then-data">
<h5>Option 2: read column names and then data<a class="headerlink" href="#option-2-read-column-names-and-then-data" title="Permalink to this headline">¶</a></h5>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [213]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="gh">Out[213]: </span><span class="go">Index([&#39;date&#39;, &#39;Param1&#39;, &#39;Param2&#39;, &#39;Param4&#39;, &#39;Param5&#39;], dtype=&#39;object&#39;)</span>

<span class="gp">In [214]: </span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>

<span class="gp">In [215]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="n">header</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gh">Out[215]: </span><span class="go"></span>
<span class="go">                     Param1  Param2  Param4  Param5</span>
<span class="go">date                                               </span>
<span class="go">1990-01-01 00:00:00       1       1       2       3</span>
<span class="go">1990-01-01 01:00:00       5       3       4       5</span>
<span class="go">1990-01-01 02:00:00       9       5       6       7</span>
<span class="go">1990-01-01 03:00:00      13       7       8       9</span>
<span class="go">1990-01-01 04:00:00      17       9      10      11</span>
<span class="go">1990-01-01 05:00:00      21      11      12      13</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sql">
<span id="cookbook-sql"></span><h3>SQL<a class="headerlink" href="#sql" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="io.html#io-sql"><span class="std std-ref">SQL</span></a> docs</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/10065051/python-pandas-and-databases-like-mysql">Reading from databases with SQL</a></p>
</div>
<div class="section" id="excel">
<span id="cookbook-excel"></span><h3>Excel<a class="headerlink" href="#excel" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="io.html#io-excel"><span class="std std-ref">Excel</span></a> docs</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15588713/sheets-of-excel-workbook-from-a-url-into-a-pandas-dataframe">Reading from a filelike handle</a></p>
<p><a class="reference external" href="http://pbpython.com/improve-pandas-excel-output.html">Modifying formatting in XlsxWriter output</a></p>
</div>
<div class="section" id="html">
<span id="cookbook-html"></span><h3>HTML<a class="headerlink" href="#html" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://stackoverflow.com/a/18939272/564538">Reading HTML tables from a server that cannot handle the default request
header</a></p>
</div>
<div class="section" id="hdfstore">
<span id="cookbook-hdf"></span><h3>HDFStore<a class="headerlink" href="#hdfstore" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="io.html#io-hdf5"><span class="std std-ref">HDFStores</span></a> docs</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/13926089/selecting-columns-from-pandas-hdfstore-table">Simple Queries with a Timestamp Index</a></p>
<p><a class="reference external" href="http://github.com/pandas-dev/pandas/issues/3032">Managing heterogeneous data using a linked multiple table hierarchy</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/14614512/merging-two-tables-with-millions-of-rows-in-python/14617925#14617925">Merging on-disk tables with millions of rows</a></p>
<p><a class="reference external" href="http://stackoverflow.com/a/29014295/2858145">Avoiding inconsistencies when writing to a store from multiple processes/threads</a></p>
<p>De-duplicating a large store by chunks, essentially a recursive reduction operation. Shows a function for taking in data from
csv file and creating a store by chunks, with date parsing as well.
<a class="reference external" href="http://stackoverflow.com/questions/16110252/need-to-compare-very-large-files-around-1-5gb-in-python/16110391#16110391">See here</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/20428355/appending-column-to-frame-of-hdf-file-in-pandas/20428786#20428786">Creating a store chunk-by-chunk from a csv file</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16997048/how-does-one-append-large-amounts-of-data-to-a-pandas-hdfstore-and-get-a-natural/16999397#16999397">Appending to a store, while creating a unique index</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/14262433/large-data-work-flows-using-pandas">Large Data work flows</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16997048/how-does-one-append-large-amounts-of-data-to-a-pandas-hdfstore-and-get-a-natural">Reading in a sequence of files, then providing a global unique index to a store while appending</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15798209/pandas-group-by-query-on-large-data-in-hdfstore">Groupby on a HDFStore with low group density</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/25459982/trouble-with-grouby-on-millions-of-keys-on-a-chunked-file-in-python-pandas/25471765#25471765">Groupby on a HDFStore with high group density</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/22777284/improve-query-performance-from-a-large-hdfstore-table-with-pandas/22820780#22820780">Hierarchical queries on a HDFStore</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/20497897/converting-dict-of-dicts-into-pandas-dataframe-memory-issues">Counting with a HDFStore</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15488809/how-to-trouble-shoot-hdfstore-exception-cannot-find-the-correct-atom-type">Troubleshoot HDFStore exceptions</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/15988871/hdfstore-appendstring-dataframe-fails-when-string-column-contents-are-longer">Setting min_itemsize with strings</a></p>
<p><a class="reference external" href="http://stackoverflow.com/questions/17893370/ptrepack-sortby-needs-full-index">Using ptrepack to create a completely-sorted-index on a store</a></p>
<p>Storing Attributes to a group node</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [216]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="gp">In [217]: </span><span class="n">store</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="s1">&#39;test.h5&#39;</span><span class="p">)</span>

<span class="gp">In [218]: </span><span class="n">store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

<span class="go"># you can store an arbitrary Python object via pickle</span>
<span class="gp">In [219]: </span><span class="n">store</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">my_attribute</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>

<span class="gp">In [220]: </span><span class="n">store</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">my_attribute</span>
<span class="gh">Out[220]: </span><span class="go">{&#39;A&#39;: 10}</span>
</pre></div>
</div>
</div>
<div class="section" id="binary-files">
<span id="cookbook-binary"></span><h3>Binary Files<a class="headerlink" href="#binary-files" title="Permalink to this headline">¶</a></h3>
<p>pandas readily accepts NumPy record arrays, if you need to read in a binary
file consisting of an array of C structs. For example, given this C program
in a file called <code class="docutils literal notranslate"><span class="pre">main.c</span></code> compiled with <code class="docutils literal notranslate"><span class="pre">gcc</span> <span class="pre">main.c</span> <span class="pre">-std=gnu99</span></code> on a
64-bit machine,</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp"></span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_Data</span>
<span class="p">{</span>
    <span class="kt">int32_t</span> <span class="n">count</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">avg</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">scale</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Data</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="kt">size_t</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="n">Data</span> <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">count</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">avg</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">;</span>
        <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">scale</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">2.0f</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">FILE</span> <span class="o">*</span><span class="n">file</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;binary.dat&quot;</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">);</span>
    <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">Data</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="n">file</span><span class="p">);</span>
    <span class="n">fclose</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>the following Python code will read the binary file <code class="docutils literal notranslate"><span class="pre">'binary.dat'</span></code> into a
pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, where each element of the struct corresponds to a column
in the frame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;avg&#39;</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span>

<span class="c1"># note that the offsets are larger than the size of the type because of</span>
<span class="c1"># struct padding</span>
<span class="n">offsets</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span>
<span class="n">formats</span> <span class="o">=</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">({</span><span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span> <span class="s1">&#39;offsets&#39;</span><span class="p">:</span> <span class="n">offsets</span><span class="p">,</span> <span class="s1">&#39;formats&#39;</span><span class="p">:</span> <span class="n">formats</span><span class="p">},</span>
              <span class="n">align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="s1">&#39;binary.dat&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The offsets of the structure elements may be different depending on the
architecture of the machine on which the file was created. Using a raw
binary file format like this for general data storage is not recommended, as
it is not cross platform. We recommended either HDF5 or msgpack, both of
which are supported by pandas’ IO facilities.</p>
</div>
</div>
</div>
<div class="section" id="computation">
<h2>Computation<a class="headerlink" href="#computation" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://nbviewer.ipython.org/5720498">Numerical integration (sample-based) of a time series</a></p>
<div class="section" id="correlation">
<h3>Correlation<a class="headerlink" href="#correlation" title="Permalink to this headline">¶</a></h3>
<p>Often it’s useful to obtain the lower (or upper) triangular form of a correlation matrix calculated from <a class="reference internal" href="../reference/api/pandas.DataFrame.corr.html#pandas.DataFrame.corr" title="pandas.DataFrame.corr"><code class="xref py py-func docutils literal notranslate"><span class="pre">DataFrame.corr()</span></code></a>.  This can be achieved by passing a boolean mask to <code class="docutils literal notranslate"><span class="pre">where</span></code> as follows:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [221]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>

<span class="gp">In [222]: </span><span class="n">corr_mat</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="gp">In [223]: </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">corr_mat</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">),</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [224]: </span><span class="n">corr_mat</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="gh">Out[224]: </span><span class="go"></span>
<span class="go">          0         1         2         3   4</span>
<span class="go">0       NaN       NaN       NaN       NaN NaN</span>
<span class="go">1  0.100443       NaN       NaN       NaN NaN</span>
<span class="go">2  0.012441 -0.068965       NaN       NaN NaN</span>
<span class="go">3  0.009641  0.078722 -0.067531       NaN NaN</span>
<span class="go">4 -0.065089 -0.156980 -0.004463  0.075126 NaN</span>
</pre></div>
</div>
<p>The <cite>method</cite> argument within <cite>DataFrame.corr</cite> can accept a callable in addition to the named correlation types.  Here we compute the <a class="reference external" href="https://en.wikipedia.org/wiki/Distance_correlation">distance correlation</a> matrix for a <cite>DataFrame</cite> object.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [225]: </span><span class="k">def</span> <span class="nf">distcorr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">   .....: </span>    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">   .....: </span>

<span class="gp">In [226]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>

<span class="gp">In [227]: </span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">distcorr</span><span class="p">)</span>
<span class="gh">Out[227]: </span><span class="go"></span>
<span class="go">     0    1    2</span>
<span class="go">0  1.0  NaN  NaN</span>
<span class="go">1  NaN  1.0  NaN</span>
<span class="go">2  NaN  NaN  1.0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="timedeltas">
<h2>Timedeltas<a class="headerlink" href="#timedeltas" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="timedeltas.html#timedeltas-timedeltas"><span class="std std-ref">Timedeltas</span></a> docs.</p>
<p><a class="reference external" href="http://github.com/pandas-dev/pandas/pull/2899">Using timedeltas</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [228]: </span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="gp">In [229]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2012-1-1&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">))</span>

<span class="gp">In [230]: </span><span class="n">s</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gh">Out[230]: </span><span class="go"></span>
<span class="go">0   -2 days</span>
<span class="go">1   -1 days</span>
<span class="go">2    0 days</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [231]: </span><span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">s</span>
<span class="go">                                                                      Out[231]: </span>
<span class="go">0   2 days</span>
<span class="go">1   1 days</span>
<span class="go">2   0 days</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [232]: </span><span class="n">s</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">                                                                                                                                         Out[232]: </span>
<span class="go">0   364 days 20:55:00</span>
<span class="go">1   365 days 20:55:00</span>
<span class="go">2   366 days 20:55:00</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [233]: </span><span class="n">s</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                             Out[233]: </span>
<span class="go">0   2012-01-01 00:05:00</span>
<span class="go">1   2012-01-02 00:05:00</span>
<span class="go">2   2012-01-03 00:05:00</span>
<span class="go">dtype: datetime64[ns]</span>

<span class="gp">In [234]: </span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                      Out[234]: </span>
<span class="go">0   -365 days +03:05:00</span>
<span class="go">1   -366 days +03:05:00</span>
<span class="go">2   -367 days +03:05:00</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [235]: </span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                Out[235]: </span>
<span class="go">0   2012-01-01 00:05:00</span>
<span class="go">1   2012-01-02 00:05:00</span>
<span class="go">2   2012-01-03 00:05:00</span>
<span class="go">dtype: datetime64[ns]</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/16385785/add-days-to-dates-in-dataframe">Adding and subtracting deltas and dates</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [236]: </span><span class="n">deltas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>

<span class="gp">In [237]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">s</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="n">deltas</span><span class="p">})</span>

<span class="gp">In [238]: </span><span class="n">df</span>
<span class="gh">Out[238]: </span><span class="go"></span>
<span class="go">           A      B</span>
<span class="go">0 2012-01-01 0 days</span>
<span class="go">1 2012-01-02 1 days</span>
<span class="go">2 2012-01-03 2 days</span>

<span class="gp">In [239]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;New Dates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>

<span class="gp">In [240]: </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Delta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;New Dates&#39;</span><span class="p">]</span>

<span class="gp">In [241]: </span><span class="n">df</span>
<span class="gh">Out[241]: </span><span class="go"></span>
<span class="go">           A      B  New Dates   Delta</span>
<span class="go">0 2012-01-01 0 days 2012-01-01  0 days</span>
<span class="go">1 2012-01-02 1 days 2012-01-03 -1 days</span>
<span class="go">2 2012-01-03 2 days 2012-01-05 -2 days</span>

<span class="gp">In [242]: </span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="go">                                                                                                                                                                       Out[242]: </span>
<span class="go">A             datetime64[ns]</span>
<span class="go">B            timedelta64[ns]</span>
<span class="go">New Dates     datetime64[ns]</span>
<span class="go">Delta        timedelta64[ns]</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p><a class="reference external" href="http://stackoverflow.com/questions/15683588/iterating-through-a-pandas-dataframe">Another example</a></p>
<p>Values can be set to NaT using np.nan, similar to datetime</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [243]: </span><span class="n">y</span> <span class="o">=</span> <span class="n">s</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>

<span class="gp">In [244]: </span><span class="n">y</span>
<span class="gh">Out[244]: </span><span class="go"></span>
<span class="go">0      NaT</span>
<span class="go">1   1 days</span>
<span class="go">2   1 days</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [245]: </span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="gp">In [246]: </span><span class="n">y</span>
<span class="gh">Out[246]: </span><span class="go"></span>
<span class="go">0      NaT</span>
<span class="go">1      NaT</span>
<span class="go">2   1 days</span>
<span class="go">dtype: timedelta64[ns]</span>
</pre></div>
</div>
</div>
<div class="section" id="aliasing-axis-names">
<h2>Aliasing Axis Names<a class="headerlink" href="#aliasing-axis-names" title="Permalink to this headline">¶</a></h2>
<p>To globally provide aliases for axis names, one can define these 2 functions:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [247]: </span><span class="k">def</span> <span class="nf">set_axis_alias</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">alias</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_AXIS_NUMBERS</span><span class="p">:</span>
<span class="gp">   .....: </span>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;invalid axis [</span><span class="si">%s</span><span class="s2">] for alias [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">alias</span><span class="p">))</span>
<span class="gp">   .....: </span>    <span class="bp">cls</span><span class="o">.</span><span class="n">_AXIS_ALIASES</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span> <span class="o">=</span> <span class="n">axis</span>
<span class="gp">   .....: </span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [248]: </span><span class="k">def</span> <span class="nf">clear_axis_alias</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">alias</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_AXIS_NUMBERS</span><span class="p">:</span>
<span class="gp">   .....: </span>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;invalid axis [</span><span class="si">%s</span><span class="s2">] for alias [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">alias</span><span class="p">))</span>
<span class="gp">   .....: </span>    <span class="bp">cls</span><span class="o">.</span><span class="n">_AXIS_ALIASES</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="gp">   .....: </span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [249]: </span><span class="n">set_axis_alias</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="s1">&#39;myaxis2&#39;</span><span class="p">)</span>

<span class="gp">In [250]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;c2&#39;</span><span class="p">],</span>
<span class="gp">   .....: </span>                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [251]: </span><span class="n">df2</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;myaxis2&#39;</span><span class="p">)</span>
<span class="gh">Out[251]: </span><span class="go"></span>
<span class="go">i1   -0.842809</span>
<span class="go">i2   -2.136732</span>
<span class="go">i3   -0.596719</span>
<span class="go">dtype: float64</span>

<span class="gp">In [252]: </span><span class="n">clear_axis_alias</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="s1">&#39;myaxis2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-example-data">
<h2>Creating Example Data<a class="headerlink" href="#creating-example-data" title="Permalink to this headline">¶</a></h2>
<p>To create a dataframe from every combination of some given values, like R’s <code class="docutils literal notranslate"><span class="pre">expand.grid()</span></code>
function, we can create a dict where the keys are column names and the values are lists
of the data values:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [253]: </span><span class="k">def</span> <span class="nf">expand_grid</span><span class="p">(</span><span class="n">data_dict</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">rows</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">   .....: </span>

<span class="gp">In [254]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">expand_grid</span><span class="p">({</span><span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span>
<span class="gp">   .....: </span>                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span>
<span class="gp">   .....: </span>                  <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">]})</span>
<span class="gp">   .....: </span>

<span class="gp">In [255]: </span><span class="n">df</span>
<span class="gh">Out[255]: </span><span class="go"></span>
<span class="go">    height  weight     sex</span>
<span class="go">0       60     100    Male</span>
<span class="go">1       60     100  Female</span>
<span class="go">2       60     140    Male</span>
<span class="go">3       60     140  Female</span>
<span class="go">4       60     180    Male</span>
<span class="go">5       60     180  Female</span>
<span class="go">6       70     100    Male</span>
<span class="go">7       70     100  Female</span>
<span class="go">8       70     140    Male</span>
<span class="go">9       70     140  Female</span>
<span class="go">10      70     180    Male</span>
<span class="go">11      70     180  Female</span>
</pre></div>
</div>
</div>
</div>


                    </div>
                </div>
            </div>

            
            <div class="clearer"></div>
        </div>
    </div>
</div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ecosystem.html" title="pandas Ecosystem"
             >next</a> |</li>
        <li class="right" >
          <a href="gotchas.html" title="Frequently Asked Questions (FAQ)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pandas 0.24.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >User Guide</a> &#187;</li> 
      </ul>
    </div>
<style type="text/css">
    .scrollToTop {
        text-align: center;
        font-weight: bold;
        position: fixed;
        bottom: 60px;
        right: 40px;
        display: none;
    }
</style>
<a href="#" class="scrollToTop">Scroll To Top</a>
<script type="text/javascript">
$(document).ready(function() {
    //Check to see if the window is top if not then display button
    $(window).scroll(function() {
        if ($(this).scrollTop() > 200) {
            $('.scrollToTop').fadeIn();
        } else {
            $('.scrollToTop').fadeOut();
        }
    });

    //Click event to scroll to top
    $('.scrollToTop').click(function() {
        $('html, body').animate({
            scrollTop: 0
        }, 500);
        return false;
    });
});
</script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-27880019-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </body>
</html>