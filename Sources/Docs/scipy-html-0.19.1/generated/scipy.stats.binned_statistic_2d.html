<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.stats.binned_statistic_2d &mdash; SciPy v0.19.1 Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.19.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v0.19.1 Reference Guide" href="../index.html" >
    <link rel="up" title="Statistical functions (scipy.stats)" href="../stats.html" >
    <link rel="next" title="scipy.stats.binned_statistic_dd" href="scipy.stats.binned_statistic_dd.html" >
    <link rel="prev" title="scipy.stats.binned_statistic" href="scipy.stats.binned_statistic.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SciPy v0.19.1 Reference Guide</a></li>
	
          <li class="active"><a href="../stats.html" accesskey="U">Statistical functions (<code class="docutils literal"><span class="pre">scipy.stats</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.stats.binned_statistic_dd.html" title="scipy.stats.binned_statistic_dd"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.stats.binned_statistic.html" title="scipy.stats.binned_statistic"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo">
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.stats.binned_statistic.html"
                        title="previous chapter">scipy.stats.binned_statistic</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.stats.binned_statistic_dd.html"
                        title="next chapter">scipy.stats.binned_statistic_dd</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-stats-binned-statistic-2d">
<h1>scipy.stats.binned_statistic_2d<a class="headerlink" href="#scipy-stats-binned-statistic-2d" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.stats.binned_statistic_2d">
<code class="descclassname">scipy.stats.</code><code class="descname">binned_statistic_2d</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>values</em>, <em>statistic='mean'</em>, <em>bins=10</em>, <em>range=None</em>, <em>expand_binnumbers=False</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/scipy/scipy/blob/v0.19.1/scipy/stats/_binned_statistic.py#L190-L347"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.stats.binned_statistic_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a bidimensional binned statistic for one or more sets of data.</p>
<p>This is a generalization of a histogram2d function.  A histogram divides
the space into bins, and returns the count of the number of points in
each bin.  This function allows the computation of the sum, mean, median,
or other statistic of the values (or set of values) within each bin.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : (N,) array_like</p>
<blockquote>
<div><p>A sequence of values to be binned along the first dimension.</p>
</div></blockquote>
<p><strong>y</strong> : (N,) array_like</p>
<blockquote>
<div><p>A sequence of values to be binned along the second dimension.</p>
</div></blockquote>
<p><strong>values</strong> : (N,) array_like or list of (N,) array_like</p>
<blockquote>
<div><p>The data on which the statistic will be computed.  This must be
the same shape as <em class="xref py py-obj">x</em>, or a list of sequences - each with the same
shape as <em class="xref py py-obj">x</em>.  If <em class="xref py py-obj">values</em> is such a list, the statistic will be
computed on each independently.</p>
</div></blockquote>
<p><strong>statistic</strong> : string or callable, optional</p>
<blockquote>
<div><p>The statistic to compute (default is &#8216;mean&#8217;).
The following statistics are available:</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;mean&#8217; : compute the mean of values for points within each bin.
Empty bins will be represented by NaN.</li>
<li>&#8216;median&#8217; : compute the median of values for points within each
bin. Empty bins will be represented by NaN.</li>
<li>&#8216;count&#8217; : compute the count of points within each bin.  This is
identical to an unweighted histogram.  <em class="xref py py-obj">values</em> array is not
referenced.</li>
<li>&#8216;sum&#8217; : compute the sum of values for points within each bin.
This is identical to a weighted histogram.</li>
<li>&#8216;min&#8217; : compute the minimum of values for points within each bin.
Empty bins will be represented by NaN.</li>
<li>&#8216;max&#8217; : compute the maximum of values for point within each bin.
Empty bins will be represented by NaN.</li>
<li>function : a user-defined function which takes a 1D array of
values, and outputs a single numerical statistic. This function
will be called on the values in each bin.  Empty bins will be
represented by function([]), or NaN if this returns an error.</li>
</ul>
</div></blockquote>
</div></blockquote>
<p><strong>bins</strong> : int or [int, int] or array_like or [array, array], optional</p>
<blockquote>
<div><p>The bin specification:</p>
<blockquote>
<div><ul class="simple">
<li>the number of bins for the two dimensions (nx = ny = bins),</li>
<li>the number of bins in each dimension (nx, ny = bins),</li>
<li>the bin edges for the two dimensions (x_edge = y_edge = bins),</li>
<li>the bin edges in each dimension (x_edge, y_edge = bins).</li>
</ul>
</div></blockquote>
<p>If the bin edges are specified, the number of bins will be,
(nx = len(x_edge)-1, ny = len(y_edge)-1).</p>
</div></blockquote>
<p><strong>range</strong> : (2,2) array_like, optional</p>
<blockquote>
<div><p>The leftmost and rightmost edges of the bins along each dimension
(if not specified explicitly in the <em class="xref py py-obj">bins</em> parameters):
[[xmin, xmax], [ymin, ymax]]. All values outside of this range will be
considered outliers and not tallied in the histogram.</p>
</div></blockquote>
<p><strong>expand_binnumbers</strong> : bool, optional</p>
<blockquote>
<div><p>&#8216;False&#8217; (default): the returned <em class="xref py py-obj">binnumber</em> is a shape (N,) array of
linearized bin indices.
&#8216;True&#8217;: the returned <em class="xref py py-obj">binnumber</em> is &#8216;unraveled&#8217; into a shape (2,N)
ndarray, where each row gives the bin numbers in the corresponding
dimension.
See the <em class="xref py py-obj">binnumber</em> returned value, and the <em class="xref py py-obj">Examples</em> section.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.17.0.</span></p>
</div>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>statistic</strong> : (nx, ny) ndarray</p>
<blockquote>
<div><p>The values of the selected statistic in each two-dimensional bin.</p>
</div></blockquote>
<p><strong>x_edge</strong> : (nx + 1) ndarray</p>
<blockquote>
<div><p>The bin edges along the first dimension.</p>
</div></blockquote>
<p><strong>y_edge</strong> : (ny + 1) ndarray</p>
<blockquote>
<div><p>The bin edges along the second dimension.</p>
</div></blockquote>
<p><strong>binnumber</strong> : (N,) array of ints or (2,N) ndarray of ints</p>
<blockquote class="last">
<div><p>This assigns to each element of <em class="xref py py-obj">sample</em> an integer that represents the
bin in which this observation falls.  The representation depends on the
<em class="xref py py-obj">expand_binnumbers</em> argument.  See <em class="xref py py-obj">Notes</em> for details.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.digitize.html#numpy.digitize" title="(in NumPy v1.13)"><code class="xref py py-obj docutils literal"><span class="pre">numpy.digitize</span></code></a>, <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.histogram2d.html#numpy.histogram2d" title="(in NumPy v1.13)"><code class="xref py py-obj docutils literal"><span class="pre">numpy.histogram2d</span></code></a>, <a class="reference internal" href="scipy.stats.binned_statistic.html#scipy.stats.binned_statistic" title="scipy.stats.binned_statistic"><code class="xref py py-obj docutils literal"><span class="pre">binned_statistic</span></code></a>, <a class="reference internal" href="scipy.stats.binned_statistic_dd.html#scipy.stats.binned_statistic_dd" title="scipy.stats.binned_statistic_dd"><code class="xref py py-obj docutils literal"><span class="pre">binned_statistic_dd</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Binedges:
All but the last (righthand-most) bin is half-open.  In other words, if
<em class="xref py py-obj">bins</em> is <code class="docutils literal"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4]</span></code>, then the first bin is <code class="docutils literal"><span class="pre">[1,</span> <span class="pre">2)</span></code> (including 1,
but excluding 2) and the second <code class="docutils literal"><span class="pre">[2,</span> <span class="pre">3)</span></code>.  The last bin, however, is
<code class="docutils literal"><span class="pre">[3,</span> <span class="pre">4]</span></code>, which <em>includes</em> 4.</p>
<p><em class="xref py py-obj">binnumber</em>:
This returned argument assigns to each element of <em class="xref py py-obj">sample</em> an integer that
represents the bin in which it belongs.  The representation depends on the
<em class="xref py py-obj">expand_binnumbers</em> argument. If &#8216;False&#8217; (default): The returned
<em class="xref py py-obj">binnumber</em> is a shape (N,) array of linearized indices mapping each
element of <em class="xref py py-obj">sample</em> to its corresponding bin (using row-major ordering).
If &#8216;True&#8217;: The returned <em class="xref py py-obj">binnumber</em> is a shape (2,N) ndarray where
each row indicates bin placements for each dimension respectively.  In each
dimension, a binnumber of <em class="xref py py-obj">i</em> means the corresponding value is between
(D_edge[i-1], D_edge[i]), where &#8216;D&#8217; is either &#8216;x&#8217; or &#8216;y&#8217;.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>
</pre></div>
</div>
<p>Calculate the counts with explicit bin-edges:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binx</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">biny</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ret</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binned_statistic_2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="n">binx</span><span class="p">,</span><span class="n">biny</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ret</span><span class="o">.</span><span class="n">statistic</span>
<span class="go">array([[ 2.,  1.],</span>
<span class="go">       [ 1.,  0.]])</span>
</pre></div>
</div>
<p>The bin in which each sample is placed is given by the <em class="xref py py-obj">binnumber</em>
returned parameter.  By default, these are the linearized bin indices:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ret</span><span class="o">.</span><span class="n">binnumber</span>
<span class="go">array([5, 6, 5, 9])</span>
</pre></div>
</div>
<p>The bin indices can also be expanded into separate entries for each
dimension using the <em class="xref py py-obj">expand_binnumbers</em> parameter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ret</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binned_statistic_2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="n">binx</span><span class="p">,</span><span class="n">biny</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">expand_binnumbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ret</span><span class="o">.</span><span class="n">binnumber</span>
<span class="go">array([[1, 1, 1, 2],</span>
<span class="go">       [1, 2, 1, 1]])</span>
</pre></div>
</div>
<p>Which shows that the first three elements belong in the xbin 1, and the
fourth into xbin 2; and so on for y.</p>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2016, The Scipy community.
      </li>
      <li>
      Last updated on Jun 21, 2017.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.5.3.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>